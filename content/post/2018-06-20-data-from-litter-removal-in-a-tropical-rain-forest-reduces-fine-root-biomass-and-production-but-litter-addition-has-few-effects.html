---
title: Data from Litter removal in a tropical rain forest reduces fine root biomass
  and production but litter addition has few effects
author: Jeff Walker
date: '2018-06-20'
slug: data-from-litter-removal-in-a-tropical-rain-forest-reduces-fine-root-biomass-and-production-but-litter-addition-has-few-effects
categories: []
tags:
  - linear mixed model
  - ecology
  - experiment
  - factorial
  - model selection
subtitle: ''
---



<div id="sources" class="section level1">
<h1>Sources</h1>
<p>Rodtassana C, Tanner EVJ (2018) Litter removal in a tropical rain forest reduces fine root biomass and production but litter addition has few effects. Ecology 99(3): 735-742. <a href="https://doi.org/10.1002/ecy.2143" class="uri">https://doi.org/10.1002/ecy.2143</a></p>
<p>Rodtassana C, Tanner EVJ (2018) Data from: Litter removal in a tropical rain forest reduces fine root biomass and production but litter addition has few effects. Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.f1948" class="uri">https://doi.org/10.5061/dryad.f1948</a></p>
</div>
<div id="background" class="section level1">
<h1>Background</h1>
<div id="reproducibility-key" class="section level2">
<h2>Reproducibility key</h2>
<ol style="list-style-type: decimal">
<li>Reproducibility: 1 (fails to reproduce). Not really close</li>
<li>Reproducibility: 2 (reproduces to a similar value). Differences may be due to slightly different specification of model or to slight differences in data (case may be excluded or missing)</li>
<li>Reproducibility: 3 (reproduces to decimal or random error). Differences due to rounding or stochastic part of estimation.</li>
<li>Reproducibility: 3- (reproduces to something close to random error). Differences very small and due to either different specification or stochastic or maybe algorithmic differences between packages.</li>
</ol>
<p>A “+” means that the precise method wasn’t specified and reproducibility required exploration.</p>
</div>
<div id="flags" class="section level2">
<h2>flags</h2>
<ol style="list-style-type: decimal">
<li>red flag: a method that I think is inferior, or is problematic or is simply wrong, or an interpretation that is wrong, or similar issues with the analysis.</li>
<li>code flag: a note on a “best practice” or at least better practice alternative to increase reproducibility related to the code.</li>
<li>work flow flag: a note on a “best practice” or at least better practice alternative to increase reproducibility related to the organization of the data and analysis.</li>
<li>communication flag: a note on a “best practice” or at least better practice alternative to improve communication of results.</li>
</ol>
</div>
<div id="caveats" class="section level2">
<h2>Caveats</h2>
<p>Failure to reproduce (level 1) or partial reproducibility (level 2 or 3-) very well might be an error in my coding, or my misunderstanding of the author’s methods, or my lack of knowledge of statistics generally or the R functions that I use more specifically. Similarly, my <strong>Red Flags</strong> may also represent my own lack of knowledge or best practices in statistics.</p>
</div>
</div>
<div id="reproducibility" class="section level1">
<h1>Reproducibility</h1>
<pre class="r"><code>library(knitr)
library(ggplot2)
library(readxl)
library(data.table)
library(emmeans)
library(nlme)
library(lme4)
library(lmerTest)

base_path &lt;- &quot;../data&quot; #knitr
folder &lt;- &#39;2018-06-20-data-from-litter-removal-in-a-tropical-rain-forest&#39;
fn &lt;- &#39;Root_Ecology_supplementary_materials.xlsx&#39;
file_path &lt;- paste(base_path, folder, fn, sep=&#39;/&#39;)
root &lt;- data.table(read_excel(file_path, range = cell_rows(1:16)))</code></pre>
<p>Some code used for model selection with a mixed model following Chapter 5.7 of Zuur for model selection of mixed effect models.</p>
<pre class="r"><code>select_model &lt;- function(y, x, r, dt, reml=FALSE){
  # the data are in dt
  # y is the response column name
  # x is the list of fixed effect column names
  # r is the list of random effect column names
  # it would seem wierd to have both month and plot in model
  # see 5.7 of Zuur for model selection of mixed effect models
  fixed &lt;- paste(y,&quot;~&quot;, paste(x, collapse=&#39;*&#39;))
  random &lt;- list()
  random[[1]] &lt;- paste(paste(&quot;(1|&quot;, r, &quot;)&quot;, sep=&quot;&quot;), collapse=&quot; + &quot;)
  min_aic &lt;- 1
  
  # fit random part first, if there are &gt; 1 random variables
  if(length(r) &gt; 1){
    aic &lt;- numeric(3)
    form &lt;- formula(paste(fixed, random[[1]], sep=&#39; + &#39;))
    fit1 &lt;- lmer(form, data=dt, REML=TRUE)
    aic[1] &lt;- AIC(fit1)
    r1 &lt;- r[1] # just the first random element
    random[[2]] &lt;- paste(paste(&quot;(1|&quot;, r1, &quot;)&quot;, sep=&quot;&quot;), collapse=&quot; + &quot;)
    form &lt;- formula(paste(fixed, random[[2]], sep=&#39; + &#39;))
    fit2 &lt;- lmer(form, data=dt, REML=TRUE)
    aic[2] &lt;- AIC(fit2)
    r2 &lt;- r[2] # just the second random element
    random[[3]] &lt;- paste(paste(&quot;(1|&quot;, r2, &quot;)&quot;, sep=&quot;&quot;), collapse=&quot; + &quot;)
    form &lt;- formula(paste(fixed, random[[3]], sep=&#39; + &#39;))
    fit3 &lt;- lmer(form, data=dt, REML=TRUE)
    aic[3] &lt;- AIC(fit3)
    min_aic &lt;- which(aic == min(aic))
  }
  random &lt;- random[[min_aic]]

  # fit fixed part
  form &lt;- list()
  # fit with ML, choose model, then refit with REML
  aic &lt;- numeric(4)
  form[[1]] &lt;- formula(paste(fixed, random, sep=&#39; + &#39;))
  # default is REML
  fit1 &lt;- lmer(form[[1]], data=dt, REML=reml)
  aic[1] &lt;- AIC(fit1)
  
  fixed &lt;- paste(y,&quot;~&quot;, paste(x, collapse=&#39; + &#39;))
  form[[2]] &lt;- formula(paste(fixed, random, sep=&#39; + &#39;))
  fit2 &lt;- lmer(form[[2]], data=dt, REML=reml)
  aic[2] &lt;- AIC(fit2)

  fixed &lt;- paste(y,&quot;~&quot;, x[1])
  form[[3]] &lt;- formula(paste(fixed, random, sep=&#39; + &#39;))
  fit3 &lt;- lmer(form[[3]], data=dt, REML=reml)
  aic[3] &lt;- AIC(fit3)

  fixed &lt;- paste(y,&quot;~&quot;, x[2])
  form[[4]] &lt;- formula(paste(fixed, random, sep=&#39; + &#39;))
  fit4 &lt;- lmer(form[[4]], data=dt, REML=reml)
  aic[4] &lt;- AIC(fit4)

  min_aic &lt;- which(aic == min(aic))
  return(form[[min_aic]])
}</code></pre>
<p>Note in Excel data sheet &gt; FRB = Fine root biomass (g/m2) at 0-5 cm and 0-10 cm FRL = Fine root length (m/m2 of root window) at 0-5 cm and 0-10 cm Sur = Fine root length survivorship (m/m2 of root window) at 0-10 cm Pro =Fine root length production (m/m2 of root window) at 0-10 cm IC = Fine root production from ingrowth cores (g/m2/3-months)</p>
<div id="fine-root-biomass" class="section level2">
<h2>Fine Root Biomass</h2>
<pre class="r"><code># root is in wide format - reshape to long
FRB_cols &lt;- c(&quot;FRB5cmMar13&quot;, &quot;FRB5cmApr13&quot;, &quot;FRB5cmMay13&quot;, &quot;FRB5cmJun13&quot;, &quot;FRB5cmJul13&quot;, &quot;FRB5cmAug13&quot;, &quot;FRB5cmSep13&quot;, &quot;FRB5cmOct13&quot;, &quot;FRB5cmNov13&quot;, &quot;FRB5cmDec13&quot;, &quot;FRB5cmJan14&quot;, &quot;FRB5cmFeb14&quot;, &quot;FRB10cmMar13&quot;, &quot;FRB10cmApr13&quot;, &quot;FRB10cmMay13&quot;, &quot;FRB10cmJun13&quot;, &quot;FRB10cmJul13&quot;, &quot;FRB10cmAug13&quot;, &quot;FRB10cmSep13&quot;, &quot;FRB10cmOct13&quot;, &quot;FRB10cmNov13&quot;, &quot;FRB10cmDec13&quot;)
# what are these &quot;FRB5cmJul13__1&quot;, &quot;FRB10cmJul13__1&quot; they have values more like FRL than FRB
frb &lt;- melt(root, id.vars=c(&#39;treatment&#39;, &#39;plot&#39;), measure.vars &lt;- FRB_cols, variable.name=&#39;label&#39;, value.name=&#39;FRB&#39;)
frb[, treatment:=factor(treatment)]
frb[, label:=as.character(label)]
frb[, depth:=factor(ifelse(substr(label, 4, 4)==&#39;5&#39;, 5, 10))]
frb[, month:=substr(label, nchar(label)-4, nchar(label)-2)]
dry &lt;- c(&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;)
frb[, season:=factor(ifelse(month %in% dry, &#39;dry&#39;, &#39;wet&#39;))]</code></pre>
<div id="figure-1" class="section level3">
<h3>Figure 1</h3>
<pre class="r"><code>frb5 &lt;- frb[depth==5, .(N=.N,
              FRB=mean(FRB),
              SE=sd(FRB)/sqrt(.N)),
              by=.(treatment, season)]
frb10 &lt;- frb[depth==10, .(N=.N,
              FRB=mean(FRB),
              SE=sd(FRB)/sqrt(.N)),
              by=.(treatment, season)]
frb_sum &lt;- rbind(data.table(depth=5, frb5), data.table(depth=10, frb10))
frb_sum[, Lower:=FRB-SE]
frb_sum[, Upper:=FRB+SE]
frb_sum[, season:=factor(season, c(&#39;wet&#39;, &#39;dry&#39;))]
frb_sum[, treatment:=factor(treatment, c(&#39;LR&#39;, &#39;CT&#39;, &#39;LA&#39;))]
pd &lt;- position_dodge(.6)
gg &lt;- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
  geom_col(position=pd, width=0.6, color=&#39;black&#39;) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
  scale_fill_manual(values=c(&quot;white&quot;, &quot;gray&quot;, &quot;black&quot;)) +
  facet_grid(.~depth, labeller = label_both) +
  theme_minimal(base_size=14)
gg</code></pre>
<div class="figure"><span id="fig:FRBplot"></span>
<img src="/post/2018-06-20-data-from-litter-removal-in-a-tropical-rain-forest-reduces-fine-root-biomass-and-production-but-litter-addition-has-few-effects_files/figure-html/FRBplot-1.png" alt="Reproducing Figure 1" width="672" />
<p class="caption">
Figure 1: Reproducing Figure 1
</p>
</div>
</div>
<div id="cm-depth" class="section level3">
<h3>5 cm depth</h3>
<blockquote>
<p>Fine root mass in the soil was higher in the wet season than in the dry season, both at 0-5 cm soil depth (F1, 178 = 10.2, P&lt;0.01, Fig. 1)</p>
</blockquote>
<pre class="r"><code>y &lt;- &#39;FRB&#39;
x &lt;- c(&#39;treatment&#39;, &#39;season&#39;)
r &lt;- c(&#39;plot&#39;, &#39;month&#39;) # should this include &quot;month&quot;?
dt &lt;- frb[depth==5]
# model select
form &lt;- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##           Sum Sq Mean Sq NumDF  DenDF F.value  Pr(&gt;F)   
## treatment  19206  9603.1     2 14.797  4.4071 0.03152 * 
## season     22126 22125.5     1 11.823 10.1538 0.00796 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># anova(lmer(form, data=dt, REML=TRUE), type=3)

# manual F
1-pf(10.1538, 1, 11.823)</code></pre>
<pre><code>## [1] 0.007960845</code></pre>
<pre class="r"><code># published numbes
1-pf(10.1538, 1, 178) # hmm. okay so not &lt; 0.001</code></pre>
<pre><code>## [1] 0.001700917</code></pre>
<p>Reproducibility: 2+ (reproduces to a similar value). The F reproduces at least to rounding error only if the final model is fit with REML=FALSE. But the df are very different and they don’t give an exact p-value. The authors do not report the structure of the final model, which makes it hard to check.</p>
<blockquote>
<p>Fine root mass was lower in litter removal soils at 0-5 cm (significant, Fig. 1)… Litter addition did not significantly lower fine root mass in either 0-5 cm or 0-10 cm soils (Fig. 1 and Appendix S1: Fig. S1).</p>
</blockquote>
<pre class="r"><code>fit &lt;- lmer(form, data=dt, REML=FALSE)
b_table &lt;- emmeans(fit, pairwise ~ treatment | season)[[2]]</code></pre>
<pre><code>## Loading required namespace: pbkrtest</code></pre>
<pre class="r"><code>kable(b_table, digits=3, caption=&#39;Tukey&#39;)</code></pre>
<table>
<caption><span id="tab:FRB5cmContrasts">Table 1: </span>Tukey</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">season</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - LA</td>
<td align="left">dry</td>
<td align="right">27.857</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">1.526</td>
<td align="right">0.303</td>
</tr>
<tr class="even">
<td align="left">CT - LR</td>
<td align="left">dry</td>
<td align="right">49.038</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">2.687</td>
<td align="right">0.039</td>
</tr>
<tr class="odd">
<td align="left">LA - LR</td>
<td align="left">dry</td>
<td align="right">21.182</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">1.161</td>
<td align="right">0.491</td>
</tr>
<tr class="even">
<td align="left">CT - LA</td>
<td align="left">wet</td>
<td align="right">27.857</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">1.526</td>
<td align="right">0.303</td>
</tr>
<tr class="odd">
<td align="left">CT - LR</td>
<td align="left">wet</td>
<td align="right">49.038</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">2.687</td>
<td align="right">0.039</td>
</tr>
<tr class="even">
<td align="left">LA - LR</td>
<td align="left">wet</td>
<td align="right">21.182</td>
<td align="right">18.25</td>
<td align="right">17.664</td>
<td align="right">1.161</td>
<td align="right">0.491</td>
</tr>
</tbody>
</table>
<p>Reproducibility: 3 (reproduces to decimal or random error). The pattern is the same but the authors only report letters indicating significance clusters.</p>
</div>
<div id="cm-depth-1" class="section level3">
<h3>10 cm depth</h3>
<blockquote>
<p>and at 0-10 cm soil depth (F1, 178 = 14.9, P&lt;0.001, Fig. 1)</p>
</blockquote>
<pre class="r"><code>y &lt;- &#39;FRB&#39;
x &lt;- c(&#39;treatment&#39;, &#39;season&#39;)
r &lt;- c(&#39;plot&#39;, &#39;month&#39;) # should this include &quot;month&quot;?
dt &lt;- frb[depth==10]
# model select
form &lt;- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##        Sum Sq Mean Sq NumDF  DenDF F.value  Pr(&gt;F)  
## season  10096   10096     1 9.5667  3.3346 0.09915 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># anova(lmer(form, data=dt, REML=TRUE), type=3)</code></pre>
<p>This isn’t close. Explore</p>
<pre class="r"><code>form &lt;- formula(FRB ~ season*treatment + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                   Sum Sq Mean Sq NumDF   DenDF F.value  Pr(&gt;F)  
## season           10103.0 10103.0     1   9.653  3.3600 0.09777 .
## treatment         9887.1  4943.6     2  18.978  1.6441 0.21953  
## season:treatment  2722.7  1361.4     2 125.621  0.4528 0.63690  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season+treatment + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##           Sum Sq Mean Sq NumDF   DenDF F.value  Pr(&gt;F)  
## season     10176 10176.4     1  9.6539  3.3602 0.09776 .
## treatment  12791  6395.5     2 14.9302  2.1118 0.15573  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##        Sum Sq Mean Sq NumDF  DenDF F.value  Pr(&gt;F)  
## season  10096   10096     1 9.5667  3.3346 0.09915 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season*treatment + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                   Sum Sq Mean Sq NumDF   DenDF F.value   Pr(&gt;F)   
## season           24422.6 24422.6     1 134.993  7.3795 0.007461 **
## treatment        10915.2  5457.6     2  19.575  1.6490 0.217840   
## season:treatment  2722.7  1361.4     2 134.993  0.4113 0.663584   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season+treatment + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##           Sum Sq Mean Sq NumDF DenDF F.value   Pr(&gt;F)   
## season     24423 24422.6     1   135  7.3348 0.007639 **
## treatment  14295  7147.6     2    15  2.1466 0.151407   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##        Sum Sq Mean Sq NumDF  DenDF F.value   Pr(&gt;F)   
## season  24423   24423     1 134.98  7.3348 0.007639 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season*treatment + (1|month))
anova(lmer(form, data=dt, REML=FALSE))</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                   Sum Sq Mean Sq NumDF  DenDF F.value  Pr(&gt;F)  
## season           14595.5 14595.5     1  10.00  3.5681 0.08822 .
## treatment        31277.2 15638.6     2 140.02  3.8231 0.02418 *
## season:treatment  2722.7  1361.4     2 140.02  0.3328 0.71748  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season*treatment)
anova(lm(form, data=dt))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: FRB
##                   Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## season             1  24423 24422.6  5.4854 0.020546 * 
## treatment          2  55624 27812.2  6.2467 0.002503 **
## season:treatment   2   2723  1361.4  0.3058 0.737034   
## Residuals        144 641132  4452.3                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>form &lt;- formula(FRB ~ season + treatment)
anova(lm(form, data=dt))</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: FRB
##            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## season      1  24423   24423  5.5381 0.01994 * 
## treatment   2  55624   27812  6.3067 0.00236 **
## Residuals 146 643855    4410                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Reproducibility: 1 (fails to reproduce).</p>
<p>None of these result in F with anything near 14.9</p>
</div>
</div>
<div id="fine-root-length" class="section level2">
<h2>Fine Root Length</h2>
<pre class="r"><code>FRL_cols &lt;- c(&quot;FRL5cmJun13&quot;, &quot;FRL5cmAug13&quot;, &quot;FRL5cmSep13&quot;, &quot;FRL5cmOct13&quot;, &quot;FRL5cmNov13&quot;, &quot;FRL5cmDec13&quot;, &quot;FRL5cmJan14&quot;, &quot;FRL5cmFeb14&quot;, &quot;FRL5cmMar14&quot;, &quot;FRL5cmApr14&quot;, &quot;FRL5cmMay14&quot;, &quot;FRL10cmJun13&quot;, &quot;FRL10cmAug13&quot;, &quot;FRL10cmSep13&quot;,  &quot;FRL10cmOct13&quot;, &quot;FRL10cmNov13&quot;, &quot;FRL10cmDec13&quot;, &quot;FRL10cmJan14&quot;, &quot;FRL10cmFeb14&quot;, &quot;FRL10cmMar14&quot;, &quot;FRL10cmApr14&quot;, &quot;FRL10cmMay14&quot;)
# what are these &quot;FRB5cmJul13__1&quot;, &quot;FRB10cmJul13__1&quot; they have values more like FRL than FRB
frl &lt;- melt(root, id.vars=c(&#39;treatment&#39;, &#39;plot&#39;), measure.vars &lt;- FRL_cols, variable.name=&#39;label&#39;, value.name=&#39;FRL&#39;)
frl[, treatment:=factor(treatment)]
frl[, label:=as.character(label)]
frl[, depth:=factor(ifelse(substr(label, 4, 4)==&#39;5&#39;, 5, 10))]
frl[, month:=substr(label, nchar(label)-4, nchar(label)-2)]
dry &lt;- c(&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;)
frl[, season:=factor(ifelse(month %in% dry, &#39;dry&#39;, &#39;wet&#39;))]</code></pre>
<div id="figure-3-a-b" class="section level3">
<h3>Figure 3 A &amp; B</h3>
<pre class="r"><code>frl5 &lt;- frl[depth==5, .(N=.N,
              FRL=mean(FRL),
              SE=sd(FRL)/sqrt(.N)),
              by=.(treatment, season)]
frl10 &lt;- frl[depth==10, .(N=.N,
              FRL=mean(FRL),
              SE=sd(FRL)/sqrt(.N)),
              by=.(treatment, season)]
frl_sum &lt;- rbind(data.table(depth=5, frl5), data.table(depth=10, frl10))
frl_sum[, Lower:=FRL-SE]
frl_sum[, Upper:=FRL+SE]
frl_sum[, season:=factor(season, c(&#39;wet&#39;, &#39;dry&#39;))]
frl_sum[, treatment:=factor(treatment, c(&#39;LR&#39;, &#39;CT&#39;, &#39;LA&#39;))]
pd &lt;- position_dodge(.6)
gg &lt;- ggplot(data=frl_sum, aes(x=season, y=FRL, fill=treatment)) +
  geom_col(position=pd, width=0.6, color=&#39;black&#39;) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
  scale_fill_manual(values=c(&quot;white&quot;, &quot;gray&quot;, &quot;black&quot;)) +
  facet_grid(.~depth, labeller = label_both) +
  theme_minimal(base_size=14)
gg</code></pre>
<div class="figure"><span id="fig:FRLplot"></span>
<img src="/post/2018-06-20-data-from-litter-removal-in-a-tropical-rain-forest-reduces-fine-root-biomass-and-production-but-litter-addition-has-few-effects_files/figure-html/FRLplot-1.png" alt="Reproducing Figure 3 A &amp; B. I've combined into single plot" width="672" />
<p class="caption">
Figure 2: Reproducing Figure 3 A &amp; B. I’ve combined into single plot
</p>
</div>
</div>
<div id="cm-depth-2" class="section level3">
<h3>5 cm depth</h3>
<pre class="r"><code>y &lt;- &#39;FRL&#39;
x &lt;- c(&#39;treatment&#39;, &#39;season&#39;)
r &lt;- c(&#39;plot&#39;, &#39;month&#39;)
dt &lt;- frl[depth==5]

# model select
form &lt;- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3)</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                   Sum Sq Mean Sq NumDF   DenDF F.value   Pr(&gt;F)    
## treatment         4224.6  2112.3     2  15.285   8.118 0.003960 ** 
## season            3921.8  3921.8     1  10.381  15.072 0.002842 ** 
## treatment:season 18247.5  9123.8     2 139.766  35.063 4.56e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Reproducibility: 2 (reproduces to a similar value). Differences may be due to slightly different specification of model or to slight differences in data (case may be excluded or missing)</p>
<blockquote>
<p>Seasonal changes in rainfall had similar effects on standing fine root length as for fine root mass, which overall was higher in the wet season for 0-5 cm soil (Table 1 and Fig. 3a)</p>
</blockquote>
<p><strong>red flag</strong> Table 1 and Fig. 3a do not provide the inference for this because of the substantial interaction, with the direction of the season effect for control opposite of that for LA and LR.</p>
<pre class="r"><code>fit &lt;- lmer(form, data=dt, REML=FALSE)
emmeans(fit, pairwise ~ season)[[2]]</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>##  contrast   estimate       SE    df t.ratio p.value
##  dry - wet -14.09524 3.867959 11.59  -3.644  0.0036
## 
## Results are averaged over the levels of: treatment</code></pre>
<p>This supports the statement generally but it should be qualified given the interaction.</p>
<blockquote>
<p>There was a significant interaction between treatment and season; standing length in litter removal was not significantly lower than controls in the wet season but was significantly lower in the dry season (Figs. 3a and 3b).</p>
</blockquote>
<pre class="r"><code>fit &lt;- lmer(form, data=dt, REML=FALSE)
b_table &lt;- emmeans(fit, pairwise ~ treatment | season)[[2]]
kable(b_table, digits=3, caption=&#39;Tukey&#39;)</code></pre>
<table>
<caption><span id="tab:FRL5Contrasts">Table 2: </span>Tukey</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">season</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - LA</td>
<td align="left">dry</td>
<td align="right">28.650</td>
<td align="right">10.567</td>
<td align="right">27.206</td>
<td align="right">2.711</td>
<td align="right">0.030</td>
</tr>
<tr class="even">
<td align="left">CT - LR</td>
<td align="left">dry</td>
<td align="right">47.000</td>
<td align="right">10.567</td>
<td align="right">27.206</td>
<td align="right">4.448</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">LA - LR</td>
<td align="left">dry</td>
<td align="right">18.350</td>
<td align="right">10.567</td>
<td align="right">27.206</td>
<td align="right">1.737</td>
<td align="right">0.210</td>
</tr>
<tr class="even">
<td align="left">CT - LA</td>
<td align="left">wet</td>
<td align="right">-24.686</td>
<td align="right">10.017</td>
<td align="right">21.187</td>
<td align="right">-2.464</td>
<td align="right">0.056</td>
</tr>
<tr class="odd">
<td align="left">CT - LR</td>
<td align="left">wet</td>
<td align="right">16.200</td>
<td align="right">10.017</td>
<td align="right">21.187</td>
<td align="right">1.617</td>
<td align="right">0.260</td>
</tr>
<tr class="even">
<td align="left">LA - LR</td>
<td align="left">wet</td>
<td align="right">40.886</td>
<td align="right">10.017</td>
<td align="right">21.187</td>
<td align="right">4.081</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>Reproducibility: 3 (reproduces to decimal or random error). The pattern is the same but the authors only report letters indicating significance clusters.</p>
<p><strong>communications flag</strong> – “not significantly lower than controls in the wet season” is a strange way to report this since the LA treatment is <em>greater than</em> control. It’s not simply the same pattern but “not statistically significant”</p>
</div>
<div id="cm-depth-3" class="section level3">
<h3>10 cm depth</h3>
<pre class="r"><code>y &lt;- &#39;FRL&#39;
x &lt;- c(&#39;treatment&#39;, &#39;season&#39;)
r &lt;- c(&#39;plot&#39;, &#39;month&#39;)
dt &lt;- frl[depth==10]

# model select
form &lt;- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3)</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                  Sum Sq Mean Sq NumDF   DenDF F.value    Pr(&gt;F)    
## treatment         13907  6953.5     2  15.284   9.024  0.002583 ** 
## season             2675  2674.6     1  10.800   3.471  0.089846 .  
## treatment:season  52863 26431.6     2 139.768  34.303 7.576e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Reproducibility: 2 (reproduces to a similar value). Differences may be due to slightly different specification of model or to slight differences in data (case may be excluded or missing)</p>
<p><strong>communication flag</strong> the authors should report the exact p-value instead of “n.s.” as (1) n.s. is not reproducible and (2) readers may have different interpretations of p (not NHST).</p>
<pre class="r"><code>fit &lt;- lmer(form, data=dt, REML=FALSE)
b_table &lt;- emmeans(fit, pairwise ~ treatment | season)[[2]]
kable(b_table, digits=3, caption=&#39;Tukey&#39;)</code></pre>
<table>
<caption><span id="tab:FRL10Contrast">Table 3: </span>Tukey</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">season</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - LA</td>
<td align="left">dry</td>
<td align="right">59.750</td>
<td align="right">14.666</td>
<td align="right">32.110</td>
<td align="right">4.074</td>
<td align="right">0.001</td>
</tr>
<tr class="even">
<td align="left">CT - LR</td>
<td align="left">dry</td>
<td align="right">81.000</td>
<td align="right">14.666</td>
<td align="right">32.110</td>
<td align="right">5.523</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">LA - LR</td>
<td align="left">dry</td>
<td align="right">21.250</td>
<td align="right">14.666</td>
<td align="right">32.110</td>
<td align="right">1.449</td>
<td align="right">0.329</td>
</tr>
<tr class="even">
<td align="left">CT - LA</td>
<td align="left">wet</td>
<td align="right">-28.429</td>
<td align="right">13.477</td>
<td align="right">22.002</td>
<td align="right">-2.109</td>
<td align="right">0.111</td>
</tr>
<tr class="odd">
<td align="left">CT - LR</td>
<td align="left">wet</td>
<td align="right">16.943</td>
<td align="right">13.477</td>
<td align="right">22.002</td>
<td align="right">1.257</td>
<td align="right">0.433</td>
</tr>
<tr class="even">
<td align="left">LA - LR</td>
<td align="left">wet</td>
<td align="right">45.371</td>
<td align="right">13.477</td>
<td align="right">22.002</td>
<td align="right">3.367</td>
<td align="right">0.008</td>
</tr>
</tbody>
</table>
<p>Reproducibility: 3 (reproduces to decimal or random error). The pattern is the same but the authors only report letters indicating significance clusters.</p>
<p><strong>communications flag</strong> – Same as for 5 cm, that is, “not significantly lower than controls in the wet season” is a strange way to report this since the LA treatment is <em>greater than</em> control. It’s not simply the same pattern but “not statistically significant”</p>
</div>
</div>
<div id="root-length-production" class="section level2">
<h2>Root Length Production</h2>
<pre class="r"><code>rlp_cols &lt;- c(&quot;ProJul13&quot;, &quot;ProAug13&quot;, &quot;ProSep13&quot;, &quot;ProOct13&quot;, &quot;ProNov13&quot;, &quot;ProDec13&quot;, &quot;ProJan14&quot;, &quot;ProFeb14&quot;, &quot;ProMar14&quot;, &quot;ProApr14&quot;, &quot;ProMay14&quot;)

rlp &lt;- melt(root, id.vars=c(&#39;treatment&#39;, &#39;plot&#39;), measure.vars &lt;- rlp_cols, variable.name=&#39;label&#39;, value.name=&#39;Prod&#39;)
rlp[, treatment:=factor(treatment)]
rlp[, label:=as.character(label)]
rlp[, depth:=factor(ifelse(substr(label, 4, 4)==&#39;5&#39;, 5, 10))]
rlp[, month:=substr(label, nchar(label)-4, nchar(label)-2)]
dry &lt;- c(&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;)
rlp[, season:=factor(ifelse(month %in% dry, &#39;dry&#39;, &#39;wet&#39;))]

# sample size
# rlp[, .(N=.N), by=.(treatment, season, depth)]
# rlp[, .(N=.N), by=.(treatment, season, depth, month)]
# rlp[, .(N=.N), by=.(treatment, season, plot)]</code></pre>
<div id="figure-3c" class="section level3">
<h3>Figure 3C</h3>
<pre class="r"><code>rlp_sum &lt;- rlp[,.(N=.N,
              Prod=mean(Prod),
              SE=sd(Prod)/sqrt(.N)),
              by=.(treatment, season)]
rlp_sum[, Lower:=Prod-SE]
rlp_sum[, Upper:=Prod+SE]
rlp_sum[, season:=factor(season, c(&#39;wet&#39;, &#39;dry&#39;))]
rlp_sum[, treatment:=factor(treatment, c(&#39;LR&#39;, &#39;CT&#39;, &#39;LA&#39;))]
pd &lt;- position_dodge(.6)
gg &lt;- ggplot(data=rlp_sum, aes(x=season, y=Prod, fill=treatment)) +
  geom_col(position=pd, width=0.6, color=&#39;black&#39;) +
  geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
  scale_fill_manual(values=c(&quot;white&quot;, &quot;gray&quot;, &quot;black&quot;)) +
  theme_minimal(base_size=14)
gg</code></pre>
<p><img src="/post/2018-06-20-data-from-litter-removal-in-a-tropical-rain-forest-reduces-fine-root-biomass-and-production-but-litter-addition-has-few-effects_files/figure-html/fig3c-1.png" width="672" /></p>
</div>
<div id="anova" class="section level3">
<h3>anova</h3>
<pre class="r"><code>y &lt;- &#39;Prod&#39;
x &lt;- c(&#39;treatment&#39;, &#39;season&#39;)
r &lt;- c(&#39;plot&#39;, &#39;month&#39;)
dt &lt;- rlp # there is no measure at 5 cm

# model select
form &lt;- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3)</code></pre>
<pre><code>## Analysis of Variance Table of type III  with  Satterthwaite 
## approximation for degrees of freedom
##                   Sum Sq Mean Sq NumDF   DenDF F.value    Pr(&gt;F)    
## treatment         7949.6  3974.8     2  15.940  9.3661  0.002043 ** 
## season             834.2   834.2     1  10.881  1.9658  0.188772    
## treatment:season 26144.5 13072.3     2 139.367 30.8032 8.352e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Reproducibility: 1 (fails to reproduce) to 2 (reproduces to a similar value). My F-value for the interaction is massive relative to the reported value. The three values have an underlying similar pattern but the numbers aren’t really close.</p>
</div>
</div>
</div>
