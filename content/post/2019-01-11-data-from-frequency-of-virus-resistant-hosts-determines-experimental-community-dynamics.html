---
title: 'Data from: Frequency of virus-resistant hosts determines experimental community
  dynamics'
author: Jeff Walker
date: '2019-01-11'
slug: data-from-frequency-of-virus-resistant-hosts-determines-experimental-community-dynamics
categories: []
tags: []
subtitle: ''
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#set-up">Set up</a></li>
<li><a href="#reproducibility">Reproducibility</a><ul>
<li><a href="#missing-data">missing data</a></li>
<li><a href="#table-1">Table 1</a><ul>
<li><a href="#what-model">what model?</a></li>
<li><a href="#aov-vs.lmer">AOV vs. lmer</a></li>
<li><a href="#aov-computation">AOV computation</a></li>
<li><a href="#table-1-my-results">Table 1 – my results</a></li>
<li><a href="#table-1-reported-results">Table 1 – reported results</a></li>
<li><a href="#did-the-authors-throw-out-a3-for-chlorella-and-rotifer">Did the authors throw out A3 for Chlorella and Rotifer?</a></li>
</ul></li>
<li><a href="#table-2">Table 2</a><ul>
<li><a href="#aov-v-lmer">AOV v lmer</a></li>
<li><a href="#table-2-my-results">Table 2 – my results</a></li>
<li><a href="#table-2-reported">Table 2 – reported</a></li>
<li><a href="#did-the-authors-throw-out-a3-for-chlorella-and-rotifer-1">Did the authors throw out A3 for Chlorella and Rotifer?</a></li>
</ul></li>
<li><a href="#figure-2">Figure 2</a></li>
</ul></li>
<li><a href="#statistical-presentation">statistical presentation</a></li>
</ul>
</div>

<p>Source: Coloma S, Gaedke U, Sivonen K, Hiltunen T (2018) Frequency of virus-resistant hosts determines experimental community dynamics. Ecology 100(1): e02554. <a href="https://doi.org/10.1002/ecy.2554" class="uri">https://doi.org/10.1002/ecy.2554</a></p>
<p>Data source: Coloma S, Gaedke U, Sivonen K, Hiltunen T (2018) Data from: Frequency of virus-resistant hosts determines experimental community dynamics. Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.6r2p226" class="uri">https://doi.org/10.5061/dryad.6r2p226</a></p>
<div id="summary" class="section level1">
<h1>Summary</h1>
<ol style="list-style-type: decimal">
<li>Data sheets are missing a column for N treatment and Nodularia sheet is also missing columns for culture ID and percent resistant factor.</li>
<li>The model for the RM ANOVA is not clear given their are two factors. Only clear given degrees of freedom reported in F ratios (which is about the only value of these)</li>
<li>The ANOVA statistics reproduce for Chlorella and Rotifer only after excluding culture A3, which is present in these two data sets but missing from Nodularia and Phage. ANOVA statistics are similar for Nodularia (both tables) and for Phage (Table 1) but not Phage (Table 2).</li>
</ol>
</div>
<div id="set-up" class="section level1">
<h1>Set up</h1>
<pre class="r"><code>library(readxl)
library(ggplot2)
library(data.table)
library(emmeans)
library(lmerTest)
library(ggpubr)

data_folder &lt;- &quot;../data&quot;
folder &lt;- &quot;Data from Frequency of virus-resistant hosts determines experimental community dynamics&quot;
fn &lt;- &quot;Coloma DATA.xlsx&quot;
file_path &lt;- paste(data_folder, folder, fn, sep=&quot;/&quot;)

# for working use =TRUE, for final html use =FALSE
# images need to be moved to /static/images/data from.../image.png
knitr_path &lt;- FALSE
images_folder &lt;- &quot;../images&quot; # for working and not final html</code></pre>
<p>There is no guidance to the structure of the excel sheets and this structure is not obvious. There are 4 sheets: Nodularia, Phage, Rotifers, Chlorella. The last 3 sheets have the same structure and this seems to be</p>
<ol style="list-style-type: decimal">
<li>column A: percent native Nodularia (not phage resistant). Note the text states 3 levels (100%, 95%, and 50%), but the column has a 4th level – 99.5%</li>
<li>column B - must be the different cultures with treatment combination ID as letters. The two factors are percent native Nodularia (3 levels), which is in column 1, and N addition (2 levels) which is not identified. There are 3 x 2 = 6 treatment combinations each replicated four times. Not the additional rows with the 99.5% Native Nodularia. I am going to start by coding the first set of four within a level of native percent as “N_lim” and the second set of four as “N_rich”. Based on the F-ratios, I’m right!</li>
<li>Remaining columns must be weeks. The first row are the week levels and the second row are the week dates.</li>
</ol>
<p>The first sheet (Nodularia) has no columns labeling the treatment level for any factor. And there are clearly three sets of data that are stacked but the bottom two contain only 8 instead of 24 (or 30 with the 99.5% level) rows. I assume that the order of treatment levels is the same for this sheet as for the phage, chlorella, and rotifers sheet.</p>
<p>Create a function to process all the sheets the same.</p>
<pre class="r"><code>pre_process_data &lt;- function(dt_in, wide=FALSE){
# takes the raw imported sheet and process it for analysis
# output is long format if wide = FALSE
  
  dt &lt;- copy(dt_in)
  # set column names
  col_labels &lt;- c(&quot;native&quot;, &quot;id&quot;, &quot;0&quot;, &quot;0.5&quot;, as.character(1:20))
  setnames(dt, old=colnames(dt), new=col_labels)
  
  # add Nitrogen column by guessing
  dt[, N:=rep(rep(c(&quot;N_lim&quot;, &quot;N_rich&quot;), each=4), 2)]
  
  # cull 99.5% rows
  dt &lt;- dt[native!=99.5]
  
  # make column of 1 - native for frequency of phage-resistant Nodularia
  dt[, resistant:=100-native]
  
  # make resistant and Nitrogen factors
  dt[, resistant:=factor(resistant)]
  dt[, N:=factor(N)]
  
  # limit to weeks 0, 2,4 6, 8, 12, 20, need week zero for plots
  ycols &lt;- as.character(c(0, 2, 4, 6, 8, 12, 20))
  if(wide==TRUE){
    dt_out &lt;- dt[, .SD, .SDcols=c(&quot;resistant&quot;, &quot;id&quot;, &quot;N&quot;, ycols)]
  }else{ #long format
  dt_out &lt;- melt(dt, 
                  id.vars=c(&quot;resistant&quot;, &quot;id&quot;, &quot;N&quot;), 
                  measure.vars=ycols,
                  variable.name=&quot;week&quot;,
                  value.name=&quot;count&quot;)
  }
  return(dt_out)
}</code></pre>
<p>Note that all replicates of G and H (resistant frequency = 50%) for week 4 are missing</p>
<pre class="r"><code># phage
sheet_i &lt;- &quot;Phage&quot;
range_i &lt;- &quot;A3:X34&quot; # ignores labels as the first two columns have none
phage &lt;- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
phage_long &lt;- pre_process_data(phage)</code></pre>
<pre class="r"><code>sheet_i &lt;- &quot;Rotifers&quot;
range_i &lt;- &quot;A5:X36&quot; # skip double header and read only to week 20
rotifers &lt;- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
rotifers_long &lt;- pre_process_data(rotifers)</code></pre>
<pre class="r"><code>sheet_i &lt;- &quot;Chlorella&quot;
range_i &lt;- &quot;A4:X35&quot; # skip double header and read only to week 20
# add first two columns as in other three
chlorella &lt;- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
chlorella_long &lt;- pre_process_data(chlorella)</code></pre>
<p>Limiting to first set of data and assume that row order is the same as in other sheets</p>
<pre class="r"><code>sheet_i &lt;- &quot;Nodularia&quot;
range_i &lt;- &quot;A5:V36&quot; # skip double header and read only to week 20
nodularia_part &lt;- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
# change colnames so not duplicate
colnames(nodularia_part) &lt;- paste(&quot;X&quot;,1:22,sep=&quot;&quot;)
nodularia &lt;- cbind(phage[, 1:2], nodularia_part)
nodularia_long &lt;- pre_process_data(nodularia)</code></pre>
</div>
<div id="reproducibility" class="section level1">
<h1>Reproducibility</h1>
<div id="missing-data" class="section level2">
<h2>missing data</h2>
<pre class="r"><code>ycols &lt;- c(&quot;resistant&quot;, &quot;id&quot;, &quot;N&quot;, &quot;2&quot;, &quot;4&quot;, &quot;6&quot;, &quot;8&quot;, &quot;12&quot;, &quot;20&quot;)

nodularia_wide &lt;- pre_process_data(nodularia, wide=TRUE)[, .SD, .SDcols=ycols]
# culture A3 is missing all counts so the design is unbalanced

phage_wide &lt;- pre_process_data(phage, wide=TRUE)[, .SD, .SDcols=ycols]
# culture A3 is missing all counts, so design is unbalanced
# F2-3, G1-4, H1-4 are missing week 4

chlorella_wide &lt;- pre_process_data(chlorella, wide=TRUE)[, .SD, .SDcols=ycols]
# no missing

rotifers_wide &lt;- pre_process_data(rotifers, wide=TRUE)[, .SD, .SDcols=ycols]
# no missing</code></pre>
<p>The nodularia and phage datasets have missing data. Nodularia is missing culture A3 and so the design is imbalanced. Phage is missing culture A3 and week 4 measures in cultures F2-3, G1-4, H1-4. This raises question of how the authors set parameters for RM ANOVA in SPSS - listwise deletion or pairwise. Also note that the imbalance raises issues for Type III ss.</p>
</div>
<div id="table-1" class="section level2">
<h2>Table 1</h2>
<div id="what-model" class="section level3">
<h3>what model?</h3>
<p>The reported F ratios have 21 degrees of freedom so the percent resistant factor cannot be in the model</p>
</div>
<div id="aov-vs.lmer" class="section level3">
<h3>AOV vs. lmer</h3>
<p>Effectively the same F, which is surprising giving lack of balance because of missing A3 in nodularia and phage. Slight difference for phage due to the missing values in F, G, and H cultures.</p>
<pre class="r"><code>summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value Pr(&gt;F)
## N          1 3.679e+12 3.679e+12   0.038  0.846
## Residuals 21 2.009e+15 9.569e+13</code></pre>
<pre class="r"><code>anova(lmer(count ~ N + (1|id), data=nodularia_long[week!=0]))</code></pre>
<pre><code>## Warning in as_lmerModLT(model, devfun): Model may not have converged with 1
## eigenvalue close to zero: 4.8e-11</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##       Sum Sq    Mean Sq NumDF DenDF F value Pr(&gt;F)
## N 3.6641e+11 3.6641e+11     1    21  0.0384 0.8464</code></pre>
<pre class="r"><code>summary(aov(count ~ N + Error(id), phage_long[week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value Pr(&gt;F)
## N          1 7.360e+12 7.360e+12   0.602  0.446
## Residuals 21 2.566e+14 1.222e+13</code></pre>
<pre class="r"><code>anova(lmer(count ~ N + (1|id), data=phage_long[week!=0]))</code></pre>
<pre><code>## Warning in as_lmerModLT(model, devfun): Model may not have converged with 1
## eigenvalue close to zero: 4.1e-11</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##       Sum Sq    Mean Sq NumDF      DenDF F value Pr(&gt;F)
## N 7.3602e+12 7.3602e+12     1 7.5442e+40  0.5925 0.4415</code></pre>
<pre class="r"><code>summary(aov(count ~ N + Error(id), chlorella_long[week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value Pr(&gt;F)
## N          1 1.385e+14 1.385e+14   1.559  0.225
## Residuals 22 1.954e+15 8.884e+13</code></pre>
<pre class="r"><code>anova(lmer(count ~ N + (1|id), data=chlorella_long[week!=0]))</code></pre>
<pre><code>## Warning in as_lmerModLT(model, devfun): Model may not have converged with 1
## eigenvalue close to zero: 2.1e-11</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##       Sum Sq    Mean Sq NumDF DenDF F value Pr(&gt;F)
## N 3.5283e+13 3.5283e+13     1    22   1.559 0.2249</code></pre>
<pre class="r"><code>summary(aov(count ~ N + Error(id), rotifers_long[week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## N          1  14194   14194   14.59 0.000935 ***
## Residuals 22  21403     973                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(lmer(count ~ N + (1|id), data=rotifers_long[week!=0]))</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##   Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    
## N 6533.4  6533.4     1    22   14.59 0.0009354 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="aov-computation" class="section level3">
<h3>AOV computation</h3>
<p>I’m using AOV but, as above, lmer wouldn’t really differ.</p>
<pre class="r"><code>stats &lt;- c(&quot;Df2&quot;, &quot;F value1&quot;, &quot;Pr(&gt;F)1&quot;)
aov1 &lt;- unlist(summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$&quot;Error: id&quot;)[stats]
aov2 &lt;- unlist(summary(aov(count ~ N + Error(id), phage_long[week!=0]))$&quot;Error: id&quot;)[stats]
aov3 &lt;- unlist(summary(aov(count ~ N + Error(id), chlorella_long[week!=0]))$&quot;Error: id&quot;)[stats]
aov4 &lt;- unlist(summary(aov(count ~ N + Error(id), rotifers_long[week!=0]))$&quot;Error: id&quot;)[stats]
table_1 &lt;- data.table(component=c(&quot;Nodularia&quot;, &quot;Phage&quot;, &quot;Chlorella&quot;, &quot;Rotifer&quot;),
                      rbind(aov1, aov2, aov3, aov4))
setnames(table_1, old=colnames(table_1), new=c(&quot;component&quot;, &quot;DDF&quot;, &quot;F&quot;, &quot;p&quot;))</code></pre>
</div>
<div id="table-1-my-results" class="section level3">
<h3>Table 1 – my results</h3>
<pre class="r"><code>knitr::kable(table_1, digits=c(NA, 0, 3, 3))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">component</th>
<th align="right">DDF</th>
<th align="right">F</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nodularia</td>
<td align="right">21</td>
<td align="right">0.038</td>
<td align="right">0.846</td>
</tr>
<tr class="even">
<td align="left">Phage</td>
<td align="right">21</td>
<td align="right">0.602</td>
<td align="right">0.446</td>
</tr>
<tr class="odd">
<td align="left">Chlorella</td>
<td align="right">22</td>
<td align="right">1.559</td>
<td align="right">0.225</td>
</tr>
<tr class="even">
<td align="left">Rotifer</td>
<td align="right">22</td>
<td align="right">14.590</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
</div>
<div id="table-1-reported-results" class="section level3">
<h3>Table 1 – reported results</h3>
<p><img src="/images/Data%20from%20Frequency%20of%20virus-resistant%20hosts%20determines%20experimental%20community%20dynamics/table1.png" /><!-- --></p>
<p>My results are qualitatively similar – are the differences simply software implementation differences? (this would seem large for that). Note that I have 22 DDF for Chlorella and Rotifer but the authors report 21 DDF for all groups, despite Chlorella and Rotifer not having missing data.</p>
</div>
<div id="did-the-authors-throw-out-a3-for-chlorella-and-rotifer" class="section level3">
<h3>Did the authors throw out A3 for Chlorella and Rotifer?</h3>
<p>yes! Compare to reported Table 1</p>
<pre class="r"><code>summary(aov(count ~ N + Error(id), chlorella_long[week!=0 &amp; id!=&quot;A3&quot;]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value Pr(&gt;F)
## N          1 1.634e+14 1.634e+14    1.79  0.195
## Residuals 21 1.917e+15 9.129e+13</code></pre>
<pre class="r"><code>summary(aov(count ~ N + Error(id), rotifers_long[week!=0 &amp; id!=&quot;A3&quot;]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## N          1  13303   13303   13.07 0.00162 **
## Residuals 21  21371    1018                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="table-2" class="section level2">
<h2>Table 2</h2>
<div id="aov-v-lmer" class="section level3">
<h3>AOV v lmer</h3>
<pre class="r"><code>summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value   Pr(&gt;F)    
## resistant  2 9.157e+13 4.578e+13   56.22 1.95e-05 ***
## Residuals  8 6.515e+12 8.144e+11                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(lmer(count ~ resistant + (1|id), phage_long[N==&quot;N_lim&quot; &amp; week!=0]))</code></pre>
<pre><code>## Warning in as_lmerModLT(model, devfun): Model may not have converged with 1
## eigenvalue close to zero: 2.7e-11</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##               Sum Sq    Mean Sq NumDF DenDF F value  Pr(&gt;F)   
## resistant 9.1566e+13 4.5783e+13     2   Inf  5.3207 0.00489 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value  Pr(&gt;F)    
## resistant  2 1.501e+14 7.503e+13   79.56 1.9e-06 ***
## Residuals  9 8.487e+12 9.430e+11                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>anova(lmer(count ~ resistant + (1|id), phage_long[N==&quot;N_rich&quot; &amp; week!=0]))</code></pre>
<pre><code>## Warning in as_lmerModLT(model, devfun): Model may not have converged with 1
## eigenvalue close to zero: 1.9e-11</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##               Sum Sq    Mean Sq NumDF DenDF F value   Pr(&gt;F)   
## resistant 1.5007e+14 7.5033e+13     2   Inf  5.7929 0.003049 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>These are very different but the AOV results are closer to reported Table 2.</p>
<pre class="r"><code>show_full_table &lt;- FALSE
if(show_full_table==TRUE){
  summary(aov(count ~ resistant + Error(id), nodularia_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), nodularia_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), chlorella_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), chlorella_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), rotifers_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;
  summary(aov(count ~ resistant + Error(id), rotifers_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;
}

stats &lt;- c(&quot;Df2&quot;, &quot;F value1&quot;, &quot;Pr(&gt;F)1&quot;)
aov1a &lt;- unlist(summary(aov(count ~ resistant + Error(id), nodularia_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov2a &lt;- unlist(summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov3a &lt;- unlist(summary(aov(count ~ resistant + Error(id), chlorella_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov4a &lt;- unlist(summary(aov(count ~ resistant + Error(id), rotifers_long[N==&quot;N_lim&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov1b &lt;- unlist(summary(aov(count ~ resistant + Error(id), nodularia_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov2b &lt;- unlist(summary(aov(count ~ resistant + Error(id), phage_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov3b &lt;- unlist(summary(aov(count ~ resistant + Error(id), chlorella_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
aov4b &lt;- unlist(summary(aov(count ~ resistant + Error(id), rotifers_long[N==&quot;N_rich&quot; &amp; week!=0]))$&quot;Error: id&quot;)[stats]
table_2 &lt;- data.table(component=rep(c(&quot;Nodularia&quot;, &quot;Phage&quot;, &quot;Chlorella&quot;, &quot;Rotifer&quot;), each=2),
                      treatment=rep(c(&quot;N_lim&quot;, &quot;N_rich&quot;), 2),
                      rbind(aov1a, aov1b, aov2a, aov2b, aov3a, aov3b, aov4a, aov4b))
setnames(table_2, old=colnames(table_2), new=c(&quot;component&quot;, &quot;treatment&quot;, &quot;DDF&quot;, &quot;F&quot;, &quot;p&quot;))</code></pre>
</div>
<div id="table-2-my-results" class="section level3">
<h3>Table 2 – my results</h3>
<pre class="r"><code>knitr::kable(table_2, digits=c(NA, NA, 0, 2, 5))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">component</th>
<th align="left">treatment</th>
<th align="right">DDF</th>
<th align="right">F</th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nodularia</td>
<td align="left">N_lim</td>
<td align="right">8</td>
<td align="right">405.62</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="left">Nodularia</td>
<td align="left">N_rich</td>
<td align="right">9</td>
<td align="right">69.51</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">Phage</td>
<td align="left">N_lim</td>
<td align="right">8</td>
<td align="right">56.22</td>
<td align="right">0.00002</td>
</tr>
<tr class="even">
<td align="left">Phage</td>
<td align="left">N_rich</td>
<td align="right">9</td>
<td align="right">79.56</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">Chlorella</td>
<td align="left">N_lim</td>
<td align="right">9</td>
<td align="right">41.70</td>
<td align="right">0.00003</td>
</tr>
<tr class="even">
<td align="left">Chlorella</td>
<td align="left">N_rich</td>
<td align="right">9</td>
<td align="right">169.62</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">Rotifer</td>
<td align="left">N_lim</td>
<td align="right">9</td>
<td align="right">2.48</td>
<td align="right">0.13898</td>
</tr>
<tr class="even">
<td align="left">Rotifer</td>
<td align="left">N_rich</td>
<td align="right">9</td>
<td align="right">317.96</td>
<td align="right">0.00000</td>
</tr>
</tbody>
</table>
</div>
<div id="table-2-reported" class="section level3">
<h3>Table 2 – reported</h3>
<p><img src="/images/Data%20from%20Frequency%20of%20virus-resistant%20hosts%20determines%20experimental%20community%20dynamics/table2.png" /><!-- --></p>
</div>
<div id="did-the-authors-throw-out-a3-for-chlorella-and-rotifer-1" class="section level3">
<h3>Did the authors throw out A3 for Chlorella and Rotifer?</h3>
<p>yes. compare to reported table 2</p>
<pre class="r"><code>summary(aov(count ~ resistant + Error(id), 
                            chlorella_long[N==&quot;N_lim&quot; &amp; 
                                             id!=&quot;A3&quot; &amp;
                                             week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df    Sum Sq   Mean Sq F value   Pr(&gt;F)    
## resistant  2 6.614e+14 3.307e+14   38.38 7.93e-05 ***
## Residuals  8 6.893e+13 8.616e+12                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>summary(aov(count ~ resistant + Error(id), 
                            rotifers_long[N==&quot;N_lim&quot; &amp;
                                            id!=&quot;A3&quot; &amp;
                                            week!=0]))$&quot;Error: id&quot;</code></pre>
<pre><code>##           Df Sum Sq Mean Sq F value Pr(&gt;F)
## resistant  2  30.71   15.36   1.461  0.288
## Residuals  8  84.08   10.51</code></pre>
</div>
</div>
<div id="figure-2" class="section level2">
<h2>Figure 2</h2>
<p>Using the raw (not modeled) means</p>
<pre class="r"><code>dt &lt;- rbind(data.table(component=&quot;Nodularia&quot;, nodularia_long),
            data.table(component=&quot;Phage&quot;, phage_long),
            data.table(component=&quot;Chlorella&quot;, chlorella_long),
            data.table(component=&quot;Rotifers&quot;, rotifers_long))
dt[, week:=as.integer(as.character(week))]
dt[, component:=factor(component, c(&quot;Nodularia&quot;, &quot;Phage&quot;, &quot;Chlorella&quot;, &quot;Rotifers&quot;))]
# raw means
raw_means &lt;- na.omit(dt[, .(count=mean(count, na.rm=TRUE)), by=.(component, resistant, N, week)])

gg &lt;- ggplot(data=raw_means, aes(x=week, y=count, group=resistant, color=resistant)) +
  geom_point() +
  geom_line() +
  scale_y_continuous(trans=&#39;log10&#39;) + 
  scale_color_manual(values=c(&quot;black&quot;, &quot;green&quot;, &quot;red&quot;)) +
  facet_grid(component~N, scales=&quot;free&quot;) +
  NULL
gg</code></pre>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<p><img src="/post/2019-01-11-data-from-frequency-of-virus-resistant-hosts-determines-experimental-community-dynamics_files/figure-html/Figure%202%20repro-1.png" width="672" /></p>
<p><img src="/images/Data%20from%20Frequency%20of%20virus-resistant%20hosts%20determines%20experimental%20community%20dynamics/fig2.png" /><!-- --></p>
</div>
</div>
<div id="statistical-presentation" class="section level1">
<h1>statistical presentation</h1>
<p>“The statistical analysis showed a lack of significant difference between N-lim and N-rich medium conditions for Nodularia, phage 2AV2 and Chlorella densities (F1,21 = 0.1, P &gt; 0.05, F1,21 = 0.7, P &gt; 0.05, and F1,21 = 1.8, P &gt; 0.05, respectively; Table 1)”</p>
<p>“In contrast, rotifer densities differed significantly between N-lim and N-rich medium conditions (F1,21 = 13.1, P &lt; 0.05)”</p>
</div>
