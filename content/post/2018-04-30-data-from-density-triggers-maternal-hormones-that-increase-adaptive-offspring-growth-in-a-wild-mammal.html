---
title: 'Data from: Density triggers maternal hormones that increase adaptive offspring growth in a wild mammal'
author: Jeff Walker
date: '2018-04-30'
slug: data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal
categories: []
tags:
  - ecology
  - physiology
  - replicates
  - red flag
  - linear mixed model
  - regression
  - anova
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#sources">Sources</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#effect-of-spruce-cone-availability-on-local-density-fig.-1b">Effect of spruce cone availability on local density (Fig. 1B)</a><ul>
<li><a href="#replication">Replication</a></li>
</ul></li>
<li><a href="#effect-of-density-on-fecal-cortisol-metabolites-fig.-3table-s4">Effect of Density on fecal cortisol metabolites (Fig. 3/Table S4)</a><ul>
<li><a href="#replication-1">Replication</a></li>
<li><a href="#red-flags">Red flags</a><ul>
<li><a href="#one-tailed-tests">one-tailed tests</a></li>
<li><a href="#forking-paths">Forking paths</a></li>
<li><a href="#confounding-density-and-treatment-in-fig-3abtable-s4">Confounding Density and Treatment in Fig 3A,B/Table S4</a></li>
<li><a href="#what-is-effect-of-ignoring-chickadee-manipulation-in-fig-3ctable-s4">What is effect of ignoring Chickadee manipulation in Fig 3C/Table S4</a></li>
<li><a href="#summary-of-red-flags-for-figure-3table-s4">Summary of Red Flags for Figure 3/Table S4</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="sources" class="section level1">
<h1>Sources</h1>
<p>Dantzer, B., Newman, A.E., Boonstra, R., Palme, R., Boutin, S., Humphries, M.M. and McAdam, A.G., 2013. Density triggers maternal hormones that increase adaptive offspring growth in a wild mammal. Science, p.1235765. <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C20&amp;q=Density+triggers+maternal+hormones+that+increase+adaptive+offspring+growth+in+a+wild+mammal&amp;btnG=" target="_blank">Google Scholar</a></p>
<p>Dantzer B, Newman AEM, Boonstra R, Palme R, Boutin S, Humphries MM, McAdam AG (2013) Data from: Density triggers maternal hormones that increase adaptive offspring growth in a wild mammal. Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.b3h4q" class="uri" target="_blank">https://doi.org/10.5061/dryad.b3h4q</a></p>
</div>
<div id="background" class="section level1">
<h1>Background</h1>
<p>The study showed that North American red squirrel (<em>Tamiasciurus hudsonicus</em>) mothers from Yukon, Alaska produce faster growing pups in years with increased squirrel density. The researchers showed this mechanism is through increased plasma levels of the stress hormone cortisol, as measured by fecal cortisol metabolites (<span class="math inline">\(FCM\)</span>) Remarkably, the researchers even showed that perceived (but not actual) density results in increased <span class="math inline">\(FCM\)</span> and faster growing pups.</p>
</div>
<div id="effect-of-spruce-cone-availability-on-local-density-fig.-1b" class="section level1">
<h1>Effect of spruce cone availability on local density (Fig. 1B)</h1>
<div id="replication" class="section level2">
<h2>Replication</h2>
<pre class="r"><code># https://datadryad.org/resource/doi:10.5061/dryad.b3h4q
# data for Fig 1B/Table Sxxx
# 
fn &lt;- &#39;Spruce cone and density data.csv&#39;
file_path &lt;- paste(base_path, &quot;data/&quot;, folder, &quot;/&quot;,fn, sep=&quot;&quot;)
cone &lt;- data.table(read.table(file_path, sep=&#39;,&#39;, header=TRUE))
fit1B &lt;- lm(Raw.Spring.Squirrel.Density ~ Previous.Year.Cones + Study.Area, data=cone[Treatment==&#39;Control&#39;])
coefficients(summary(fit1B))</code></pre>
<pre><code>##                      Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept)         0.9374918 0.18445191 5.082581 7.720402e-06
## Previous.Year.Cones 0.2439928 0.05835227 4.181377 1.397226e-04
## Study.AreaSU        0.3960932 0.17957009 2.205786 3.279269e-02</code></pre>
<pre class="r"><code>fit1B &lt;- lmer(Raw.Spring.Squirrel.Density ~ Previous.Year.Cones + (1|Study.Area), data=cone[Treatment==&#39;Control&#39;])
coefficients(summary(fit1B))</code></pre>
<pre><code>##                      Estimate Std. Error        df  t value     Pr(&gt;|t|)
## (Intercept)         1.1461764  0.2297727  1.796553 4.988306 0.0469107986
## Previous.Year.Cones 0.2387471  0.0581160 43.582879 4.108113 0.0001727167</code></pre>
<pre class="r"><code>fit1B &lt;- lmer(Raw.Spring.Squirrel.Density ~ Treatment*Previous.Year.Cones + (1|Study.Area), data=cone)
coefficients(summary(fit1B))</code></pre>
<pre><code>##                                          Estimate Std. Error        df
## (Intercept)                            1.14575993 0.22862269  1.762538
## TreatmentFood-add                      0.82670186 0.45113416  2.954381
## Previous.Year.Cones                    0.23895251 0.05697609 49.624755
## TreatmentFood-add:Previous.Year.Cones -0.03112299 0.19330047 49.065590
##                                          t value     Pr(&gt;|t|)
## (Intercept)                            5.0115758 0.0482942695
## TreatmentFood-add                      1.8324967 0.1656791801
## Previous.Year.Cones                    4.1939086 0.0001128609
## TreatmentFood-add:Previous.Year.Cones -0.1610083 0.8727479464</code></pre>
</div>
</div>
<div id="effect-of-density-on-fecal-cortisol-metabolites-fig.-3table-s4" class="section level1">
<h1>Effect of Density on fecal cortisol metabolites (Fig. 3/Table S4)</h1>
<div id="replication-1" class="section level2">
<h2>Replication</h2>
<p>To begin to investigate how squirrel density during pregnancy could control the future growth rate of pups, Dantzer et al measured the relationship between local squirrel density (the variable <span class="math inline">\(Density\)</span>) and the amount of fecal cortisol metabolites from pregnant mothers (the variable <span class="math inline">\(FCM\)</span>). Cortisol is a hormone that is secreted as part of stress response. Dantzer et al were interested in cortisol because it is known that, in mammals, blood cortisol levels in pregnant mothers have numerous effects on offspring long past birth. If increased squirrel density causes increased blood cortisol levels, then we would expect to find a positive relationship between <span class="math inline">\(Density\)</span> and <span class="math inline">\(FCM\)</span>.</p>
<p>Dantzer et al analyzed effect of <span class="math inline">\(Density\)</span> on <span class="math inline">\(FCM\)</span> with three different analyses.</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(Density\)</span> as continuous <span class="math inline">\(X\)</span>. Modeled with a linear mixed model. The data are from individual, tagged squirrels from different populations and different years. About 1/2 the data is from experimental populations with supplemented food (peanut butter) to increase density. The model includes days post conception as a covariate and squirrel <span class="math inline">\(ID\)</span> and <span class="math inline">\(Year\)</span> are modeled with random intercepts.</p></li>
<li><p>Density as levels of <span class="math inline">\(Treatment\)</span>. The two levels are N (control) and Y (supplemental peanut butter). The data are the same as in part 1 so this is not a replication or alternative probing.</p></li>
<li><p>Density as perceived density <span class="math inline">\(Treatment\)</span> with two levels: control (including both no manipulation and chickadee call manipulation) and rattle (rattle sound mimicking neighbor squirrels)</p></li>
</ol>
<pre class="r"><code># Dantzer, B., Newman, A.E., Boonstra, R., Palme, R., Boutin, S., Humphries, M.M. and McAdam, A.G., 2013. Density triggers maternal hormones that increase adaptive offspring growth in a wild mammal. Science, p.1235765.
# https://datadryad.org/resource/doi:10.5061/dryad.b3h4q
# data for Fig 3A/Table S4
# fn &lt;- &#39;Spruce cone and density data.csv&#39;
fn &lt;- &#39;FCM data dryad.csv&#39;
file_path &lt;- paste(base_path, &quot;data/&quot;, folder, &quot;/&quot;,fn, sep=&quot;&quot;)
fcmA &lt;- data.table(read.table(file_path, sep=&#39;,&#39;, header=TRUE))
# replace labels with more codeable names. Separate to insure match
setnames(fcmA, old=c(&#39;Squirrel.ID&#39;), new=c(&#39;ID&#39;))
setnames(fcmA, old=c(&#39;Year.Sample.Collected&#39;), new=c(&#39;Year&#39;))
setnames(fcmA, old=c(&#39;FCM.ng.g.dry&#39;), new=c(&#39;FCM&#39;))
setnames(fcmA, old=c(&#39;Food.Add.Grid&#39;), new=c(&#39;Treatment&#39;))
setnames(fcmA, old=c(&#39;Raw.Squirrel.Density&#39;), new=c(&#39;Density&#39;))
setnames(fcmA, old=c(&#39;scaled.days.postconception&#39;), new=c(&#39;Days_pc&#39;))
fcmA[,Treatment:=factor(Treatment)]

#lmm - replicates! but weird as uses experimental data in this without Treatment as a variable
fit_A &lt;- lmer(log(FCM) ~ Days_pc + Density + (1|Year) + (1|ID), data=fcmA, na.action=&quot;na.exclude&quot;)
table_part1 &lt;- coefficients(summary(fit_A))</code></pre>
<p>Part II</p>
<pre class="r"><code># categorical model as in Table S4 and Figure 3B - replicates!
# data same as in part 1 but re-analyzed as categorical
fit_B &lt;- lmer(log(FCM) ~ Days_pc + Treatment + (1|Year) + (1|ID), data=fcmA)
table_part2 &lt;- coefficients(summary(fit_B))</code></pre>
<p>Part III</p>
<pre class="r"><code>#Table S4, figure 3C - replicates
fn &lt;- &#39;Table S4 - playback FCM data.csv&#39;
file_path &lt;- paste(base_path, &quot;data/&quot;, folder, &quot;/&quot;,fn, sep=&quot;&quot;)
fcmC &lt;- data.table(read.table(file_path, sep=&#39;,&#39;, header=TRUE))
fcmC[,Treatment:=factor(Treatment)]
setnames(fcmC, old=c(&#39;Squirrel.Taglft&#39;), new=c(&#39;ID&#39;))
setnames(fcmC, old=c(&#39;FCM.ng.g.dry&#39;), new=c(&#39;FCM&#39;))
setnames(fcmC, old=c(&#39;scaled.days.postconception&#39;), new=c(&#39;Days_pc&#39;))
fit_C &lt;- lmer(log(FCM) ~ Days_pc + Treatment + (1|ID), data=fcmC)
table_part3 &lt;- coefficients(summary(fit_C))</code></pre>
<p>Figure S3, which is the FCM as a function of treatment level (chickadee vs. rattle) <em>prior</em> to playback</p>
<pre class="r"><code>#Supplement page 7 - methods in text, page 11 - Figure S3
fn &lt;- &#39;before.playback.fcm.data.csv&#39;
file_path &lt;- paste(base_path, &quot;data/&quot;, folder, &quot;/&quot;,fn, sep=&quot;&quot;)
fcmC_pre &lt;- data.table(read.table(file_path, sep=&#39;,&#39;, header=TRUE))
setnames(fcmC_pre, old=c(&#39;Raw.FCM.ng.g.dry&#39;), new=c(&#39;FCM&#39;))
setnames(fcmC_pre, old=c(&#39;Squirrel.Taglft&#39;), new=c(&#39;ID&#39;))
setnames(fcmC_pre, old=c(&#39;Days.Post.Conception&#39;), new=c(&#39;Days_pc&#39;))
fcmC_pre[,Treatment:=factor(Treatment)]
# model - why interaction here but not elsewhere? Note treatment effect bigger in additive model
fit3 &lt;- lmer(log(FCM) ~ Days_pc*Treatment + (1|ID), data=fcmC_pre)
tableS3_rep &lt;- coefficients(summary(fit3))
# compare to (t97 = -0.93, P = 0.17) from p. 11 of supplement
qplot(x=Treatment, y=log(FCM), data=fcmC_pre) + geom_boxplot() + geom_point()</code></pre>
<p><img src="/post/2018-04-30-data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal_files/figure-html/repS3-1.png" width="672" /></p>
<p><strong>Replicated results</strong></p>
<p>The effects, SE, and t replicate but the my <span class="math inline">\(p\)</span>-values are twice those of the authors, who must be reporting 1-tailed (directional) tests. I don’t see that they have reported that they are using 1-tailed tests. My opinion is that one-tail tests are p-hacking.</p>
<pre class="r"><code>table_part1</code></pre>
<pre><code>##               Estimate Std. Error         df   t value     Pr(&gt;|t|)
## (Intercept)  6.4524936 0.28003048   7.541837 23.042112 2.891608e-08
## Days_pc     -0.1824743 0.05137781 100.999797 -3.551618 5.834110e-04
## Density      0.3498811 0.09603582  99.282751  3.643235 4.302768e-04</code></pre>
<pre class="r"><code>table_part2</code></pre>
<pre><code>##               Estimate Std. Error        df   t value     Pr(&gt;|t|)
## (Intercept)  6.8382198 0.19668961   3.99408 34.766553 4.144391e-06
## Days_pc     -0.1853858 0.05039281 109.58188 -3.678814 3.649856e-04
## TreatmentY   0.5245187 0.13719083  88.31807  3.823278 2.448438e-04</code></pre>
<pre class="r"><code>table_part3</code></pre>
<pre><code>##                   Estimate Std. Error       df   t value    Pr(&gt;|t|)
## (Intercept)      6.9032211 0.13132470 25.83826 52.566054 0.000000000
## Days_pc         -0.2569544 0.09055173 42.04317 -2.837653 0.006966651
## TreatmentRattle  0.4148583 0.18485323 28.14263  2.244258 0.032861251</code></pre>
<p><img src="../../images/2018-04-30-data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal/tableS4.png" /><!-- --></p>
</div>
<div id="red-flags" class="section level2">
<h2>Red flags</h2>
<div id="one-tailed-tests" class="section level3">
<h3>one-tailed tests</h3>
<p>The authors reported p-values from one-tailed tests, apparently without reporting that these are one-tailed tests (at least I cannot find this with a search). As stated above, I think one-tailed tests are p-hacking – Conclusions or a decision to publish a paper in <em>Science</em> shouldn’t rest on a p-value of 0.03 or 0.06. It also assumes that effects in the opposite direction cannot exist. If one has prior information on the direction of an effect then use this in a Bayesian model.</p>
</div>
<div id="forking-paths" class="section level3">
<h3>Forking paths</h3>
<p>There is variation among the analyses. Sometimes <span class="math inline">\(Days_{pc}\)</span> includes a quadratic component sometimes not. Some analysis are factorial <span class="math inline">\(Treatment \times Days_{pc}\)</span> while others are additive. The analysis below shows no real consequences of obvious forking paths.</p>
<p>Effect of <span class="math inline">\(Density\)</span> in Table S4 part 1 is robust to forking. Effect of <span class="math inline">\(Treatment\)</span> is robust to forking.</p>
<pre class="r"><code># part 1
coefficients(summary(lmer(log(FCM) ~ Days_pc + Density + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##               Estimate Std. Error         df   t value     Pr(&gt;|t|)
## (Intercept)  6.4524936 0.28003048   7.541837 23.042112 2.891608e-08
## Days_pc     -0.1824743 0.05137781 100.999797 -3.551618 5.834110e-04
## Density      0.3498811 0.09603582  99.282751  3.643235 4.302768e-04</code></pre>
<pre class="r"><code>coefficients(summary(lmer(log(FCM) ~ Days_pc*Density + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##                   Estimate Std. Error         df   t value     Pr(&gt;|t|)
## (Intercept)      6.4691926 0.28212829   7.430514 22.929968 3.623925e-08
## Days_pc         -0.3660636 0.12851697 101.140322 -2.848368 5.323965e-03
## Density          0.3387496 0.09568353  99.861116  3.540312 6.087484e-04
## Days_pc:Density  0.1143800 0.07340514 106.782165  1.558201 1.221445e-01</code></pre>
<pre class="r"><code>coefficients(summary(lmer(log(FCM) ~ Days_pc + I(Days_pc^2) + Density + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##                Estimate Std. Error         df   t value     Pr(&gt;|t|)
## (Intercept)   6.5806195 0.29691546   7.622587 22.163277 3.377392e-08
## Days_pc      -0.1631244 0.05182675 101.913786 -3.147494 2.159939e-03
## I(Days_pc^2) -0.1222859 0.05780903 103.176319 -2.115343 3.680824e-02
## Density       0.3410313 0.09440687  99.669743  3.612357 4.773567e-04</code></pre>
<pre class="r"><code># part 2
coefficients(summary(lmer(log(FCM) ~ Days_pc + Treatment + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##               Estimate Std. Error        df   t value     Pr(&gt;|t|)
## (Intercept)  6.8382198 0.19668961   3.99408 34.766553 4.144391e-06
## Days_pc     -0.1853858 0.05039281 109.58188 -3.678814 3.649856e-04
## TreatmentY   0.5245187 0.13719083  88.31807  3.823278 2.448438e-04</code></pre>
<pre class="r"><code>coefficients(summary(lmer(log(FCM) ~ Days_pc*Treatment + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##                       Estimate Std. Error         df    t value
## (Intercept)         6.83811023 0.19863638   3.987249 34.4252662
## Days_pc            -0.20062345 0.06245086  95.960287 -3.2125009
## TreatmentY          0.52242493 0.13727552  88.087439  3.8056672
## Days_pc:TreatmentY  0.04539172 0.10849683 125.410884  0.4183691
##                        Pr(&gt;|t|)
## (Intercept)        4.383510e-06
## Days_pc            1.791723e-03
## TreatmentY         2.606627e-04
## Days_pc:TreatmentY 6.763928e-01</code></pre>
<pre class="r"><code>coefficients(summary(lmer(log(FCM) ~ Days_pc + I(Days_pc^2) + Treatment + (1|Year) + (1|ID), data=fcmA)))</code></pre>
<pre><code>##                Estimate Std. Error        df   t value     Pr(&gt;|t|)
## (Intercept)   6.9486234 0.21740756   4.53972 31.961278 1.609836e-06
## Days_pc      -0.1673698 0.05102679 110.07502 -3.280038 1.390277e-03
## I(Days_pc^2) -0.1111788 0.05669271 113.46864 -1.961078 5.232004e-02
## TreatmentY    0.5000358 0.13497025  88.12086  3.704786 3.686636e-04</code></pre>
</div>
<div id="confounding-density-and-treatment-in-fig-3abtable-s4" class="section level3">
<h3>Confounding Density and Treatment in Fig 3A,B/Table S4</h3>
<pre class="r"><code># residuals from Days_pc
fcmA[, FCM_residuals:=residuals(lm(log(FCM) ~ Days_pc, data=fcmA))]
qplot(x=Density, y=FCM_residuals, color=Treatment, data=fcmA) + geom_point() + geom_smooth(method=&#39;lm&#39;)</code></pre>
<div class="figure"><span id="fig:explorefig3a"></span>
<img src="/post/2018-04-30-data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal_files/figure-html/explorefig3a-1.png" alt="Re-plot of Figure 3A. Data color coded by Treatment level" width="672" />
<p class="caption">
Figure 1: Re-plot of Figure 3A. Data color coded by Treatment level
</p>
</div>
<pre class="r"><code># residuals from lmm
fcmA[, FCM_p1_residuals:=residuals(fit_A)]
# qplot(x=Density, y=FCM_p1_residuals, color=Treatment, data=fcmA) + geom_point() + geom_smooth(method=&#39;lm&#39;)</code></pre>
<p>Parts 1 and 2 are not independent tests of the hypothesis that density causes increased plasma cortisol, as these are the same data. Worse, <span class="math inline">\(Treatment\)</span> confounds part 1 and <span class="math inline">\(Density\)</span> confounds part 2. The effects of this confounding are seen with a simple scatterplot of the <span class="math inline">\(FCM\)</span> against <span class="math inline">\(Density\)</span> with points colored by <span class="math inline">\(Treatment\)</span> and separate regressions fit to each level (Figure <a href="#fig:explorefig3a">1</a>). If it were simply a density effect, the treated fit should not be elevated relative to the control data.</p>
<p>To unconfound these, instead of two models (parts 1 and 2), both <span class="math inline">\(Density\)</span> and <span class="math inline">\(Treatment\)</span> could be combined into the same model. (note: Does this raise colinearity issues? No the correlation is only moderate)</p>
<pre class="r"><code>cor(fcmA$Density, as.integer(fcmA$Treatment), use=&#39;complete.obs&#39;)</code></pre>
<pre><code>## [1] 0.5727619</code></pre>
<pre class="r"><code>fit2 &lt;- lmer(log(FCM) ~ Days_pc + Density + Treatment + (1|Year) + (1|ID), data=fcmA)
tableS4_part1 &lt;- coefficients(summary(fit2))
tableS4_part1</code></pre>
<pre><code>##               Estimate Std. Error         df   t value     Pr(&gt;|t|)
## (Intercept)  6.5597014 0.26168375   8.800287 25.067286 1.724396e-09
## Days_pc     -0.1805912 0.05107655 102.012602 -3.535697 6.132199e-04
## Density      0.2110840 0.11846785 113.302492  1.781783 7.746363e-02
## TreatmentY   0.3489617 0.17858010  96.717436  1.954091 5.357887e-02</code></pre>
<p><strong>Conclusion</strong> from the red-flag analysis.</p>
<p><span class="math inline">\(Density\)</span> has effect of .21 log(fcm)/squirrel-per-ha, which is 40% smaller effect than in model confounded by Treatment. Can this effect account for growth rate variation? <span class="math inline">\(Treatment\)</span> has a 50% bigger effect than <span class="math inline">\(Density\)</span> but this includes aspects of <span class="math inline">\(Treatment\)</span> that are <em>independent</em> of <span class="math inline">\(Density\)</span>. The p-values for both are not strong evidence against a trivially small effect. This should be rigorously probed in follow-up experiments.</p>
</div>
<div id="what-is-effect-of-ignoring-chickadee-manipulation-in-fig-3ctable-s4" class="section level3">
<h3>What is effect of ignoring Chickadee manipulation in Fig 3C/Table S4</h3>
<p>The data for Figure 3C/Table S4 part 3 has Treatment levels “Control” and “Rattle” but the Control level includes squirrels that were given a Chickadee playback. In fact, very little of the data is control. The coding of which were truly Control and which were Chickadee is in the File for Figure S3, which is the data for FCM for <em>pre-playback</em> squirrels in Chickadee and Rattle treatment levels. I used the tag data to identify the “Controls” in the Table S4 data that were actually “Chickadee”.</p>
<pre class="r"><code># combine into single file with three treatment levels (control + chickadee + rattle) and two time levels (before, after)
# note that days_pc is scaled in fcmC but raw in fcmC_pre
fcmC_post &lt;- copy(fcmC)
fcmC_pre[, Days_pc:=scale(Days_pc)]
temp &lt;- match(fcmC_post$ID, fcmC_pre$ID)
fcmC_post[, Treatment_chick:=fcmC_pre[temp, Treatment]]
fcmC_post[, Treatment_chick:=factor(ifelse(is.na(Treatment_chick), as.character(Treatment), as.character(Treatment_chick)), c(&#39;Control&#39;, &#39;Chickadee&#39;, &#39;Rattle&#39;))]</code></pre>
<div id="red-flag-id-f3007f3008-is-coded-as-control-in-the-playback-table-s4-data-but-as-rattle-in-the-pre-playback-data-figure-s3" class="section level4">
<h4>red flag: ID F3007/F3008 is coded as “Control” in the playback (Table S4) data but as “Rattle” in the pre-playback data (Figure S3)</h4>
<p>I don’t know the correct code but if re-coded as in the pre-playback file, there is a 10% reduction in the estimated effect and the p-value is even less evidence against a trivially small effect.</p>
<pre class="r"><code># RED FLAG - ID F3007/F3008 is coded as &quot;Control&quot; in the playback data but as &quot;Rattle&quot; in the pre-playback data
fcmC_post[ID==&#39;F3007&#39;]</code></pre>
<pre><code>##    Treatment    ID Squirrel.Tagrt       FCM    Days_pc Treatment_chick
## 1:   Control F3007          F3008 1418.4352 -0.6100946          Rattle
## 2:   Control F3007          F3008  234.8218  0.7643714          Rattle</code></pre>
<pre class="r"><code>fcmC_pre[ID==&#39;F3007&#39;]</code></pre>
<pre><code>##    Treatment    Days_pc    ID Squirrel.Tagrt      FCM
## 1:    Rattle -0.3607039 F3007          F3008 502.3092
## 2:    Rattle  0.1341818 F3007          F3008 266.5438
## 3:    Rattle  0.6290676 F3007          F3008 238.2549
## 4:    Rattle  0.8411615 F3007          F3008 269.1402
## 5:    Rattle  1.4067452 F3007          F3008 594.1501</code></pre>
<pre class="r"><code># original coefficient table that replicates
coefficients(summary(lmer(log(FCM) ~ Days_pc + Treatment + (1|ID), data=fcmC_post)))</code></pre>
<pre><code>##                   Estimate Std. Error       df   t value    Pr(&gt;|t|)
## (Intercept)      6.9032211 0.13132470 25.83826 52.566054 0.000000000
## Days_pc         -0.2569544 0.09055173 42.04317 -2.837653 0.006966651
## TreatmentRattle  0.4148583 0.18485323 28.14263  2.244258 0.032861251</code></pre>
<pre class="r"><code># recoded coefficient table with smaller effect
fcmC_post[, Treatment_F3007:=Treatment]
fcmC_post[ID==&#39;F3007&#39;, Treatment_F3007:=&#39;Rattle&#39;]
coefficients(summary(lmer(log(FCM) ~ Days_pc + Treatment_F3007 + (1|ID), data=fcmC_post)))</code></pre>
<pre><code>##                        Estimate Std. Error       df   t value   Pr(&gt;|t|)
## (Intercept)            6.948365 0.14200319 24.89544 48.931046 0.00000000
## Days_pc               -0.248192 0.09286464 41.16291 -2.672621 0.01073778
## Treatment_F3007Rattle  0.301708 0.19236365 26.49397  1.568425 0.12864943</code></pre>
</div>
<div id="red-flag-the-plot-and-table-show-that-the-effect-of-playback-on-fcm-seems-to-be-a-manipulation-factor-that-is-not-specific-to-rattle" class="section level4">
<h4>Red Flag: The plot and table show that the effect of playback on <span class="math inline">\(FCM\)</span> seems to be a manipulation factor that is not specific to Rattle</h4>
<pre class="r"><code>fcmC_post[, logFCM_residuals:=residuals(lm(log(FCM)~Days_pc, data=fcmC_post), na.action=&quot;na.exclude&quot;)]
qplot(x=Treatment_chick, y=logFCM_residuals, data=fcmC_post) + geom_point()</code></pre>
<p><img src="/post/2018-04-30-data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal_files/figure-html/TableS4C_redflag2-1.png" width="672" /></p>
<pre class="r"><code>qplot(x=Treatment_chick, y=logFCM_residuals, data=fcmC_post) + geom_point() + geom_point(data=fcmC_post[ID==&quot;F3007&quot;], color=&#39;red&#39;)</code></pre>
<p><img src="/post/2018-04-30-data-from-density-triggers-maternal-hormones-that-increase-adaptive-offspring-growth-in-a-wild-mammal_files/figure-html/TableS4C_redflag2-2.png" width="672" /></p>
<pre class="r"><code>fit3 &lt;- lmer(log(FCM) ~ Days_pc + Treatment_chick + (1|ID), data=fcmC_post)
tableS4_part3_rf &lt;- coefficients(summary(fit3))
tableS4_part3_rf</code></pre>
<pre><code>##                            Estimate Std. Error df   t value    Pr(&gt;|t|)
## (Intercept)               6.3428114 0.26941426 45 23.542969 0.000000000
## Days_pc                  -0.2395402 0.08845359 45 -2.708088 0.009534125
## Treatment_chickChickadee  0.8079943 0.30632885 45  2.637670 0.011421211
## Treatment_chickRattle     0.8974583 0.29419927 45  3.050512 0.003822111</code></pre>
</div>
</div>
<div id="summary-of-red-flags-for-figure-3table-s4" class="section level3">
<h3>Summary of Red Flags for Figure 3/Table S4</h3>
<ol style="list-style-type: decimal">
<li>The results for Figure 3A,B/Table S4 parts 1 and 2 are confounded and a re-analysis adjusting for confounding finds that much of the “difference” is due to Treatment effects that are independent of Density.</li>
<li>The results for Figure 3C/Table S4 part 3 have a coding error. I don’t know the correct code. If re-coded using pre-playback codes, then effect of Rattle playback is smaller.</li>
<li>The result in Figure 3C/Table S4 part 3 masks a chickadee treatment level. A re-analysis with this coded as a distinct level indicates that the effect is common for both treatment manipulations and increased FCM is probably due to manipulation rather than “perception of density.”</li>
</ol>
</div>
</div>
</div>
