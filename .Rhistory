<<<<<<< HEAD
coef(summary(fit.c))
library(MuMIn)
?dredge
all.c <- dredge(fit.c)
?na.action
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1, na.action = "na.omit")
coef(summary(fit.c))
all.c <- dredge(fit.c)
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1, na.action = "na.fail")
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1, na.action = "na.omit")
coef(summary(fit.c))
all.c <- dredge(fit.c)
?na.action
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1, na.action = "na.fail")
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1[!is.na(LRR.C)], na.action = "na.fail")
coef(summary(fit.c))
all.c <- dredge(fit.c)
?dredge
ma.c <- model.avg(all.c)
all.c <- dredge(fit.c)
exp1.c <- exp1[!is.na(LRR.C),] # dredge can't seem to do this.
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1.C, na.action = "na.fail")
exp1.c <- exp1[!is.na(LRR.C),] # dredge can't seem to do this.
fit.c <- lm(LRR.C ~ MAP + MAT + SOLAR.INS + SOIL.PCT.N + TREATMENT + MAP:TREATMENT + MAT:TREATMENT + SOLAR.INS:TREATMENT + SOIL.PCT.N:TREATMENT, data=exp1.c, na.action = "na.fail")
all.c <- dredge(fit.c)
ma.c <- model.avg(all.c)
all.c
subset(all.c, delta <= 1.0)
?get.models
subset(all.c, delta <= 1.0)
summary(get.models(all.c, subset= delta <= 1.0)[[2]])
?dredge
dredge(fit.c, m.lim = c(0, 2))
?subset.dredge
names(exp1.c)
names(fit.c)
terms(fit.c)
x_terms <- terms(fit.c)[-1]
x_terms
x_terms <- terms(fit.c)[-1]
x_terms
terms(fit.c)$factors
names(terms(fit.c))
factors(fit.c)
terms(fit.c)
terms(fit.c)$term.labels
terms(fit.c)["term.labels"]
terms(fit.c)[["term.labels"]]
attr(terms(fit.c), "term.labels")
names(exp1)
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
cov_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
y <- ycols[1]
y <- y_cols[1]
cov <- cov_cols[1]
?cov
covx <- cov_cols[1]
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
fit <- lm(get(y) ~ get(covx)*Treatment, data=subdata, na.action="na.fail")
head(subdata)
get(y)
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
summary(fit)
fit.all <- dredge(fit)
fit.all
?dredge
row.names(fit.all)
fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
terms_i
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
res <- data.table(NULL)
for(y in y_cols){
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res <- rbind(res, data.table(terms=terms_i, fit.order[,"AICc"]))
}
}
res
summary(fit)
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, fit.order[,"AICc"]))
}
ifelse(y==ycols[1], res <- res_part, res <- merge(res, by=terms))
}
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, fit.order[,"AICc"]))
}
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, by=terms))
}
y
res
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
setnames(res_part, "AICC", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by=terms))
}
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by=terms))
}
res
res_part
?merge
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
res_part <- res_part[, .(AICc=mean(AICc)), by=terms]
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
}
res
apply(AICc[, .SD, .SDcols=y_cols], 2, min)
AICc[, .SD, .SDcols=y_cols]
is.data.table
dAICc <- res[, .SD, .SDcols=y_cols] - apply(res[, .SD, .SDcols=y_cols], 2, min)
dAICc
apply(res[, .SD, .SDcols=y_cols], 2, min)
dAICc <- t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min))
dAICc
dAICc <- data.table(Terms = res[,terms], t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)))
dAICc
dAICc <- data.table(Terms = res[,terms], round(t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)), 1))
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
res_part <- res_part[, .(AICc=mean(AICc)), by=terms]
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
}
dAICc <- data.table(Terms = res[,terms], round(t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)), 1))
dAICc
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
res_part <- res_part[, .(AICc=mean(AICc)), by=terms]
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
}
dAICc <- data.table(Terms = res[,terms], round(t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)), 1))
dAICc
y_cols <- c("LRR.N", "LRR.C", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
res_part <- res_part[, .(AICc=mean(AICc)), by=terms]
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
}
dAICc <- data.table(Terms = res[,terms], round(t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)), 1))
dAICc
y_cols <- c("LRR.C", "LRR.N", "LRR.P", "LRR.K" )
covx_cols <- c("MAP", "MAT", "SOLAR.INS", "SOIL.PCT.N")
for(y in y_cols){
res_part <- data.table(NULL)
subdata <- exp1[!is.na(get(y)),] # dredge can't seem to do this.
for(covx in covx_cols){
fit <- lm(get(y) ~ get(covx)*TREATMENT, data=subdata, na.action="na.fail")
fit.all <- dredge(fit)
fit.order <- fit.all[ order(as.numeric(row.names(fit.all))),]
terms_i <- c("~ 1",
paste("~ ", covx, sep=""),
paste("~ ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE", sep=""),
paste("~ ", covx," + ", "FENCE"," + ", covx, ":FENCE", sep="")
)
res_part <- rbind(res_part, data.table(terms=terms_i, AICc=fit.order[,"AICc"]))
}
res_part <- res_part[, .(AICc=mean(AICc)), by=terms]
setnames(res_part, "AICc", y)
ifelse(y==y_cols[1], res <- res_part, res <- merge(res, res_part, by="terms"))
}
dAICc <- data.table(Terms = res[,terms], round(t(t(res[, .SD, .SDcols=y_cols]) - apply(res[, .SD, .SDcols=y_cols], 2, min)), 1))
dAICc
names(exp1)
m1 <- lm(LRR.C ~ MAP*TREATMENT, data=exp1)
m2 <- lm(LRR.C ~ 1, data=exp1)
AICc(m1)
m1 <- lm(LRR.C ~ MAP*TREATMENT, data=exp1)
m2 <- lm(LRR.C ~ 1, data=exp1)
AICc(m1)
AICc(m2)
AICc(m2)-AICc(m1)
mod1.dat <- exp1
# CARBON
C.mod1 <- lm(mod1.dat$LRR.C ~ 1, data=mod1.dat)
C.mod11 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAP * mod1.dat$TREATMENT, data=mod1.dat)
AICc(C.mod1) - AICc(C.mod11)
C.mod1 <- lm(mod1.dat$LRR.C ~ 1, data=mod1.dat)
C.mod2 <- lm(mod1.dat$LRR.C ~ mod1.dat$TREATMENT, data=mod1.dat)
C.mod3 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAP, data=mod1.dat)
C.mod4 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAT, data=mod1.dat)
C.mod5 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOLAR.INS, data=mod1.dat)
C.mod6 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOIL.PCT.N, data=mod1.dat)
C.mod7 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAP + mod1.dat$TREATMENT, data=mod1.dat)
C.mod8 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAT + mod1.dat$TREATMENT, data=mod1.dat)
C.mod9 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOLAR.INS + mod1.dat$TREATMENT, data=mod1.dat)
C.mod10 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOIL.PCT.N + mod1.dat$TREATMENT, data=mod1.dat)
C.mod11 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAP * mod1.dat$TREATMENT, data=mod1.dat)
C.mod12 <- lm(mod1.dat$LRR.C ~ mod1.dat$MAT * mod1.dat$TREATMENT, data=mod1.dat)
C.mod13 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOLAR.INS * mod1.dat$TREATMENT, data=mod1.dat)
C.mod14 <- lm(mod1.dat$LRR.C ~ mod1.dat$SOIL.PCT.N * mod1.dat$TREATMENT, data=mod1.dat)
# select best model by AICc model selection
AICctab(C.mod1, C.mod2, C.mod3, C.mod4, C.mod5, C.mod6, C.mod7, C.mod8, C.mod9, C.mod10,
C.mod11, C.mod12, C.mod13, C.mod14, sort=TRUE)
# load libraries
library(bbmle)
install.packages("bbmle")
library(bbmle)
library(car)
AICctab(C.mod1, C.mod2, C.mod3, C.mod4, C.mod5, C.mod6, C.mod7, C.mod8, C.mod9, C.mod10,
C.mod11, C.mod12, C.mod13, C.mod14, sort=TRUE)
?AICctab
blogdown:::serve_site()
fn <- "tableS3.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
knir::kable(dAICc)
knitr::kable(dAICc)
1.33*192
1.33*192
28*48
data_folder <- "../data"
folder <- "Data from Response of bluebunch wheatgrass to invasion- differences in competitive ability among invader-experienced and naïve populations"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
source("../R/clean_label.R") # bookdown
knitr_path <- TRUE
fn <- "Gibson_invasion_response_data.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
# offspring weight
sheet_i <- "Germination"
exp1 <- data.table(read_excel(file_path, sheet=sheet_i))
library(ggplot2)
library(readxl)
library(data.table)
library(emmeans)
library(nlme)
library(car)
fn <- "Gibson_invasion_response_data.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
# offspring weight
sheet_i <- "Germination"
exp1 <- data.table(read_excel(file_path, sheet=sheet_i))
colnames(exp1) <- clean_label(colnames(exp1))
setnames(exp1, "Type", "Experience")
# offspring weight
sheet_i <- "Traits"
exp2 <- data.table(read_excel(file_path, sheet=sheet_i, na="x"))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment:=factor(Treatment)]
exp2[, Experience:=factor(Population_Type)]
exp2[, Stage:=ifelse(as.character(Date)=="2012-04-30","Seedling", "Juvenile")]
exp2[, Exp_Pop:=factor(paste(Experience,Population,sep="."))]
=======
fit <- lme(n_Leaves ~ Treatment*Experience + Experience/Population, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
fit <- lme(n_Leaves ~ Treatment*Experience + Population/Experience, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
names(subdata)
fit <- lme(n_Leaves ~ Treatment*Experience + Exp_Pop, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
fit <- lme(n_Leaves ~ Treatment*Experience/Population, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
# But I think authors are using nlme
fit <- lme(n_Leaves ~ Treatment*Experience/Population, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
# But I think authors are using nlme
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
Experience
subdata
aov(n_Leaves ~ Treatment*Experience + Error(Experience/Population), data=subdata)
anova(aov(n_Leaves ~ Treatment*Experience + Error(Experience/Population), data=subdata))
summary(aov(n_Leaves ~ Treatment*Experience + Error(Experience/Population), data=subdata))
summary(aov(n_Leaves ~ Treatment*Experience + Experience/Population, data=subdata))
summary(aov(n_Leaves ~ Treatment*Experience + Population/Experience, data=subdata))
>>>>>>> a140fab3780995165f5c295adff0bfb7a06c6db6
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population/Experience, contrasts=con3, data=subdata)
Anova(fit.aov, type="3")
drop1(fit.aov, test="Chi")
anova(fit.aov)
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
anova(fit.aov)
drop1(fit.aov, test="Chi")
Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov)
drop1(fit.aov, test="Chi")
Anova(fit.aov, type="3")
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population + Population:Experience, contrasts=con3, data=subdata)
Anova(fit.aov, type="3")
anova(fit.aov)
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
anova(fit.aov)
Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population + Population:Experience, contrasts=con3, data=subdata)
anova(fit.aov)
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population:Experience, contrasts=con3, data=subdata)
anova(fit.aov)
Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
anova(fit.aov)
Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population:Experience, data=subdata)
anova(fit.aov)
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment*Experience, data=subdata)
anova(fit.aov)
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment*Experience, data=subdata)
anova(fit.aov)
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment + Treatment:Experience + Experience, data=subdata)
anova(fit.aov)
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov)
drop1(fit.aov, type="F")
o<-11+20/60
n<-11+58/60
m<-12+23/60
m/0
m
n
m/o
n/o
n/m
m/n
37+30/60*1.056
(37+30/60)*1.056
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
anova(fit.aov)
Anova(fit.aov, type="3")
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
anova(fit.aov)
#Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population:Experience, contrasts=con3, data=subdata)
anova(fit.aov)
#Anova(fit.aov, type="3")
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov)
fit <- lmer(n_Leaves ~ Treatment*Experience + (1|Population), data=subdata, REML = FALSE)
anova(fit, type="3")
fit <- lmer(n_Leaves ~ Treatment*Experience + (1|Population) + (1|Population:Experience), data=subdata, REML = FALSE)
anova(fit, type="3")
fit <- lmer(n_Leaves ~ Treatment*Experience + (1|Population), data=subdata, REML = FALSE)
anova(fit, type="3")
# But I think authors are using nlme
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata) # this can't work because pop and experience are not crossed
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population/Experience, data=subdata)
anova(fit, type="marginal")
it <- lme(n_Leaves ~ Treatment*Experience, random=list(Population = pdDiag(~ Experience)), data = subdata)
anova(fit, type="marginal")
fit1 <- gls(n_Leaves ~ Treatment*Experience,
weights = varIdent(form = ~1|Population),
data=subdata)
anova(fit1, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population/Experience, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population,
weights = varIdent(form = ~1|Population), data=subdata)
anova(fit, type="marginal")
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Population:Experience, data=subdata)
anova(fit.aov) # seq ss
fit.lm <- lm(n_Leaves ~ Population:Experience + Treatment*Experience, data=subdata)
Anova(fit.lm, type="3")
anova(fit.lm)
write.table(exp2, "exp2.txt", row.names=FALSE, quote=FALSE)
unique(subdata$Population)
unique(exp2$Population)
xcols <- c("Treatment", "Experience", "Stage", "Population", "Exp_Pop")
ycols <- c("Longest_leaf", "n_Leaves", "Biomass", "Shoot_biomass", "Root_biomass", "Root.shoot_ratio")
subdata <- na.omit(exp2.b[Population!="Ana" &
Stage=="Seedling" &
N > 1, .SD, .SDcols=c(xcols, ycols[2])])
counts <- exp2[!is.na(n_Leaves) & Population!="Ana", .(N=.N), by=.(Treatment, Experience, Population, Stage, Exp_Pop)]
# counts[, .(N=.N), by=.(Stage, Population)]
exp2.b <- merge(exp2, counts, by=c("Treatment", "Experience", "Population", "Stage", "Exp_Pop"))
# which(counts[, N] < 3)
xcols <- c("Treatment", "Experience", "Stage", "Population", "Exp_Pop")
ycols <- c("Longest_leaf", "n_Leaves", "Biomass", "Shoot_biomass", "Root_biomass", "Root.shoot_ratio")
subdata <- na.omit(exp2.b[Population!="Ana" &
Stage=="Seedling" &
N > 1, .SD, .SDcols=c(xcols, ycols[2])])
subdata[, Experience:=factor(Experience)]
subdata[, Population:=factor(Population)]
dim(subdata)
<<<<<<< HEAD
fit <- lmer(n_Leaves ~ Treatment*Experience + Population + (1|Population), data=subdata, REML = FALSE)
anova(fit, type="3")
library(lmerTest)
fit <- lmer(n_Leaves ~ Treatment*Experience + Population + (1|Population) + (1|Population:Experience), data=subdata, REML = FALSE)
anova(fit, type="3")
fit <- lmer(n_Leaves ~ Treatment*Experience + Population + (1|Population) + (1|Population:Experience), data=subdata, REML = TRUE)
anova(fit, type="3")
fit <- lme(n_Leaves ~ Treatment*Experience + Population, random= ~ 1|Population, data=subdata)
install.packages("blogdown")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::install_hugo()
blogdown:::serve_site()
library(ggplot2)
library(readxl)
library(data.table)
library(emmeans)
library(nlme)
library(lmerTest)
library(car)
data_folder <- "../data"
folder <- "Data from Response of bluebunch wheatgrass to invasion- differences in competitive ability among invader-experienced and naïve populations"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
source("../R/clean_label.R") # bookdown
knitr_path <- TRUE
fn <- "Gibson_invasion_response_data.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
sheet_i <- "Germination"
exp1 <- data.table(read_excel(file_path, sheet=sheet_i))
colnames(exp1) <- clean_label(colnames(exp1))
setnames(exp1, "Type", "Experience")
sheet_i <- "Traits"
exp2 <- data.table(read_excel(file_path, sheet=sheet_i, na="x"))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment:=factor(Treatment)]
exp2[, Experience:=factor(Population_Type)]
exp2[, Stage:=ifelse(as.character(Date)=="2012-04-30","Seedling", "Juvenile")]
exp2[, Exp_Pop:=factor(paste(Experience,Population,sep="."))]
counts <- exp2[!is.na(n_Leaves) & Population!="Ana", .(N=.N), by=.(Treatment, Experience, Population, Stage, Exp_Pop)]
# counts[, .(N=.N), by=.(Stage, Population)]
exp2.b <- merge(exp2, counts, by=c("Treatment", "Experience", "Population", "Stage", "Exp_Pop"))
# which(counts[, N] < 3)
xcols <- c("Treatment", "Experience", "Stage", "Population", "Exp_Pop")
ycols <- c("Longest_leaf", "n_Leaves", "Biomass", "Shoot_biomass", "Root_biomass", "Root.shoot_ratio")
subdata <- na.omit(exp2.b[Population!="Ana" &
Stage=="Seedling" &
N > 1, .SD, .SDcols=c(xcols, ycols[2])])
# check for populations that are missing from Treatment cell and exclude
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
orderBy(~Experience + Population + Treatment, data=dt)
library(doBy)
xcols <- c("Treatment", "Experience", "Stage", "Population", "Exp_Pop")
ycols <- c("Longest_leaf", "n_Leaves", "Biomass", "Shoot_biomass", "Root_biomass", "Root.shoot_ratio")
subdata <- na.omit(exp2.b[Population!="Ana" &
Stage=="Seedling" &
N > 1, .SD, .SDcols=c(xcols, ycols[2])])
# check for populations that are missing from Treatment cell and exclude
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
orderBy(~Experience + Population + Treatment, data=dt)
dt <- dt[, .(N=.N), by=Population]
inc <- dt[which(dt[, N]>1), Population]
subdata <- subdata[Population %in% inc, ]
subdata[, Experience:=factor(Experience)]
subdata[, Population:=factor(Population)]
dim(subdata)
=======
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, data=subdata)
anova(fit.aov) # seq ss
# re-arrange so that Treatment:Experience is last
fit.aov <- aov(n_Leaves ~ Population:Experience + Treatment*Experience, data=subdata)
anova(fit.aov) # seq ss
fit <- lme(n_Leaves ~ Treatment*Experience + Population/Experience, data=subdata)
fit <- lme(n_Leaves ~ Treatment*Experience + Population, data=subdata)
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Treatment*Experience, data=subdata)
Anova(fit.aov,type="3") # seq ss
fit.sum <- lm(n_Leaves ~ Treatment*Experience, contrasts=con3, data=subdata)
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.treat <- lm(n_Leaves ~ Treatment*Experience, data=subdata)
fit.sum <- lm(n_Leaves ~ Treatment*Experience, contrasts=con3, data=subdata)
fit.aov <- aov(n_Leaves ~ Treatment*Experience, data=subdata)
Anova(fit.aov,type="3") # seq ss
coef(summary(fit.treat))
coef(summary(fit.sum))
con3 <- list(Treatment=contr.sum, Experience=contr.sum) # change the contrasts coding for the model matrix
fit.treat <- lm(n_Leaves ~ Treatment*Experience, data=subdata)
fit.sum <- lm(n_Leaves ~ Treatment*Experience, contrasts=con3, data=subdata)
fit.aov <- aov(n_Leaves ~ Treatment*Experience, contrasts=con3, data=subdata)
Anova(fit.aov,type="3") # seq ss
coef(summary(fit.treat))
coef(summary(fit.sum))
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrasts=con3, data=subdata)
fit.aov <- aov(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov)
Anova(fit.aov,type="3") # seq ss
fit.sum <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
coef(summary(fit.sum))
Anova(fit.sum,type="3") # seq ss
coef(summary(fit.sum))
fit.sum <- lm(n_Leaves ~ Treatment*Experience + population, contrasts=con3, data=subdata)
fit.sum <- lm(n_Leaves ~ Treatment*Experience + Population, contrasts=con3, data=subdata)
coef(summary(fit.sum))
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Popuation=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov) # the interaction matches jmp
fit.sum <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Population=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3") # seq ss
fit.sum <- lm(n_Leaves ~ Treatment*Experience + Population, contrasts=con3, data=subdata)
coef(summary(fit.sum))
fit.sum <- lm(n_Leaves ~ Treatment*Experience + Population, contrasts=con3, data=subdata)
fit.treat <- lm(n_Leaves ~ Treatment*Experience + Population, data=subdata)
coef(summary(fit.sum))
coef(summary(fit.treat))
fit.sum <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
fit.sum2 <- lm(n_Leaves ~ Treatment*Experience + Population, contrasts=con3, data=subdata)
fit.treat <- lm(n_Leaves ~ Treatment*Experience + Population, data=subdata)
coef(summary(fit.sum)) # does not match JMP
coef(summary(fit.sum2)) # does not match JMP
fit.sum <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
fit.sum2 <- lm(n_Leaves ~  Population + Treatment*Experience, contrasts=con3, data=subdata)
fit.treat <- lm(n_Leaves ~ Treatment*Experience + Population, data=subdata)
coef(summary(fit.sum)) # does not match JMP
coef(summary(fit.sum2)) # does not match JMP
exp2.b$Population
fit.treat <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, data=subdata)
coef(summary(fit.sum)) # does not match JMP
coef(summary(fit.sum2)) # does not match JMP
coef(summary(fit.treat)) # does not match JMP
fit.sum <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
fit.sum2 <- lm(n_Leaves ~  Experience:Population + Treatment*Experience, contrasts=con3, data=subdata)
fit.sum3 <- lm(n_Leaves ~  Population/Experience + Treatment*Experience, contrasts=con3, data=subdata)
fit.treat <- lm(n_Leaves ~ Experience/Population + Treatment*Experience, data=subdata)
coef(summary(fit.sum)) # does not match JMP
coef(summary(fit.sum2)) # does not match JMP
coef(summary(fit.sum3)) # does not match JMP
coef(summary(fit.treat)) # does not match JMP
Anova(fit.sum3, type="3")
fit.sum4 <- lm(n_Leaves ~  Experience + Population/Experience + Treatment*Experience, contrasts=con3, data=subdata)
coef(summary(fit.sum4))
Anova(fit.sum4, type="3")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population/Experience, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Experience:Population, data=subdata)
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population, data=subdata)
anova(fit, type="marginal")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Experience/Population, data=subdata)
anova(fit, type="marginal")
install.packages("EMSaov")
library(EMSaov)
#EMSaov
anova.result<-EMSanova(n_Leaves ~ Treatment*Experience + Population,data=subdata,
type=c("F","F","F"),
nested=c(NA,NA,"Experience"),
level=c(1,1,1))
rate <- 1.2 # deaths per 10^7 miles
paste("A",1:10)
as.character(rep(1:10, 2))
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("A",1:10, sep=""), paste("B",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=a, B=b, pop=pop)
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("A",1:10, sep=""), paste("B",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop)
combos
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("A",1:10, sep=""), paste("B",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop)
X <- rbind(combos, combos, combos, combos, combos)
dim(X)
dim(combos)
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("A",1:10, sep=""), paste("B",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
head(fd)
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit.aov) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit.aov) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + pop2 + pop2:B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + pop2 + pop2:B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A*B + pop/B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + pop2 + pop2:B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A*B + pop2/B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A*B + B/pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + B:pop2, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A + B + A:B + pop2 + pop2:B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
fit <- aov(y ~ A*B + pop2/B, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
fit <- lm(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit)
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
fit <- aov(y ~ A*B + pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
fit <- aov(y ~ A*B + pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
fit <- aov(y ~ A + B + A:B + B:pop, contrasts=con3, data=fd)
Anova(fit, type="3")
# drop two pops from B
fd2 <- fd[pop!="B1" & pop!="B2"]
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd2)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
A <- c("A", "a")
B <- c("B", "b")
pop <- c(paste("B",1:10, sep=""), paste("b",1:10, sep=""))
pop2 <- as.character(rep(1:10, 2))
combos <- expand.grid(A=A, B=B, pop=pop, pop2=pop2)
X <- rbind(combos, combos, combos, combos, combos)
y <- rnorm(nrow(X))
fd <- data.table(y=y, X)
con3 <- list(A=contr.sum, B=contr.sum, pop=contr.sum) # change the contrasts coding for the model matrix
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
# drop two pops from B
fd2 <- fd[pop!="B1" & pop!="B2"]
fit <- aov(y ~ A*B + B/pop, contrasts=con3, data=fd2)
anova(fit) # the interaction matches jmp
Anova(fit, type="3")
dim(subdata)
subdata[1:99]
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
dt
library(doBy)
orderBy(~Population + Treatment)
orderBy(~Population + Treatment, dt)
orderBy(~Experience + Population + Treatment, dt)
dt[, .(N=.N), by=Population]
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
dt <- dt[, .(N=.N), by=Population]
exc <- which(dt[, N]<2)
exc
dt[which(dt[, N]<2),]
subdata[Population %!in% exc, ]
exc <- dt[which(dt[, N]<2), Population]
subdata <- subdata[Population !%in% exc, ]
inc <- dt[which(dt[, N]>1), Population]
subdata <- subdata[Population %in% inc, ]
>>>>>>> a140fab3780995165f5c295adff0bfb7a06c6db6
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Population=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3") # fails
<<<<<<< HEAD
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Population=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Population/Experience + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3") # fails
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Population=contr.sum) # change the contrasts coding for the model matrix
fit.aov <- aov(n_Leaves ~ Experience/Population + Treatment*Experience, contrasts=con3, data=subdata)
anova(fit.aov) # the interaction matches jmp
Anova(fit.aov,type="3") # fails
blogdown:::serve_site()
=======
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
dt <- dt[, .(N=.N), by=Population]
dt
subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
orderBy(~Experience + Population + Treatment)
orderBy(~Experience + Population + Treatment, data=dt)
dt <- subdata[, .(N=.N), by=.(Treatment, Experience, Population)]
orderBy(~Experience + Population + Treatment, data=dt)
dt[, .(N=.N), by=Population]
subdata[, Experience:=factor(Experience)]
subdata[, Population:=factor(Population)]
dim(subdata)
levels(subdata$Population)
fit.aov <- aov(n_Leaves ~ Treatment*Experience + Experience/Population, contrast=con3, data=subdata)
con3 <- list(Treatment=contr.sum, Experience=contr.sum, Population=contr.sum) # change the contrasts coding for the model matrix
Anova(fit.aov, type="3")
fit <- lme(n_Leaves ~ Treatment*Experience, random= ~ 1|Population/Experience, data=subdata)
anova(fit, type="marginal")
# But I think authors are using nlme
fit <- lme(n_Leaves ~ Treatment*Experience + Expierience/Population, data=subdata)
# But I think authors are using nlme
fit <- lme(n_Leaves ~ Treatment*Experience + Experience/Population, data=subdata)
# But I think authors are using nlme
fit <- lm(n_Leaves ~ Treatment*Experience + Experience/Population, data=subdata)
anova(fit)
fit <- lm(n_Leaves ~ Treatment*Experience + Experience/Population, contrast=con3, data=subdata)
anova(fit)
Anova(fit, type="3")
>>>>>>> a140fab3780995165f5c295adff0bfb7a06c6db6
