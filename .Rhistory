# get rid of any double "__"
x <- gsub("__", "_", x)
# replace hyphens
x <- gsub("-", "_", x)
# replace forward slash
x <- gsub("/_", ".", x)
# replace forward slash
x <- gsub("/", ".", x)
return(x)
}
exp3 <- data.table(read_excel(file_path, range="K1:U45"))
colnames(exp3) <- clean_label(colnames(exp3))
exp3[, Treatment:=factor(Treatment)]
exp3 <- data.table(read_excel(file_path, range="K1:U45"))
exp3 <- data.table(read_excel(file_path, range="K1:U45"))
colnames(exp3) <- clean_label(colnames(exp3))
exp3[, Treatment:=factor(Treatment)]
names(exp3)
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
for(y in y_list){
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
p1 <- anova(lme(fixed_i, random = ~ 1|Block, method="ML",
data=exp3))[2,]
}
p1
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
part1 <- data.table(NULL)
for(y in y_list){
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
part1 <- rbind(part1,
data.table(Response=y,
anova(lme(fixed_i, random = ~ 1|Block,
method="ML", data=exp3))[2,]))
}
part1
?count
y <- y_list[1]
y
mean(exp3[Treatment=="MC", get(y)])
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
part1 <- data.table(NULL)
exp3[, one:=1] # used for getting N in each level
for(y in y_list){
n.mc <- sum(exp3[Treatment=="MC" & !is.na(y), one])
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
part1 <- rbind(part1,
data.table(Response=y,
anova(lme(fixed_i, random = ~ 1|Block,
method="ML", data=exp3))[2,]),
Mean.MC=mean(exp3[Treatment=="MC", get(y)]),
SE.MC=sd(exp3[Treatment=="MC", get(y)]/sqrt(n.mc))
)
}
exp3[, .(mean(y_list)), by=Treatment]
exp3[, .(mean(y_list)), by=Treatment]
exp3[, .(mean(In_Nest)), by=Treatment]
levels(exp3$Treatment)
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
part1 <- data.table(NULL)
exp3[, one:=1] # used for getting N in each level
for(y in y_list){
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
part1 <- rbind(part1,
data.table(Response=y,
anova(lme(fixed_i, random = ~ 1|Block,
method="ML", data=exp3))[2,],
Mean.MC=mean(exp3[Treatment=="MC", get(y)]),
SE.MC=sd(exp3[Treatment=="MC", get(y)]),
Mean.LBE=mean(exp3[Treatment=="LBE", get(y)]),
SE.LBE=sd(exp3[Treatment=="LBE", get(y)])
))
}
part1
sum(exp3[Treatment=="MC" & !is.na(get(y)), one])
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
my_table <- data.table(NULL)
exp3[, one:=1] # used for getting N in each level
for(y in y_list){
n.mc <- sum(exp3[Treatment=="MC" & !is.na(get(y)), one])
n.lbe <- sum(exp3[Treatment=="LBE" & !is.na(get(y)), one])
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
my_table <- rbind(my_table,
data.table(Response=y,
anova(lme(fixed_i, random = ~ 1|Block,
method="ML", data=exp3))[2,],
Mean.MC=mean(exp3[Treatment=="MC", get(y)]),
SE.MC=sd(exp3[Treatment=="MC", get(y)])/sqrt(n.mc),
Mean.LBE=mean(exp3[Treatment=="LBE", get(y)]),
SE.LBE=sd(exp3[Treatment=="LBE", get(y)])/sqrt(n.lbe)
))
}
my_table
knitr::kable(my_table, digits=c(NA,0,0,2,3,2,2))
knitr::kable(my_table, digits=c(NA,0,0,2,3,2,2,2,2))
knitr::kable(my_table, digits=c(NA,0,0,2,3,2,2,2,2))
y
y
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
fixed_i
aov_4(fixed_i + (1|Block), data=exp3))
aov_4(fixed_i + (1|Block), data=exp3)
head(exp3)
exp3[, Block:=factor(Block)]
aov_4(fixed_i + (1|Block), data=exp3)
y
aov_4(Resting ~ Treatment + (1|Block), data=exp3)
aov_4(Resting ~ Treatment + (1|Block:Treatment), data=exp3)
exp3$Block
head(exp3)
head(exp3)
fit.aov_4 <- aov_4(Resting ~ Treatment + (1|Block/ID), data=exp3)
?aov_ez
aov_ez("ID", "Resting", exp3, between=c("Treatment"), within="Block")
exp3[ID==164]
head(exp3)
exp3[,.(N=.N), by=ID]
exp3[, myID:=1:.N]
exp3$myID
exp3[, myID:=factor(1:.N)]
aov_ez("myID", "Resting", exp3, between=c("Treatment"), within="Block")
aov_4(Resting ~ Treatment + (1|Block/ID), data=exp3)
aov_4(Resting ~ Treatment + (1|Block:ID), data=exp3)
exp3[ID==1,]
exp3
aov_4(Resting ~ Treatment + (1|Block:myID), data=exp3)
aov_4(Resting ~ Treatment + (1|Block), data=exp3)
aov_4(Resting ~ Treatment + (Treatment|Block), data=exp3)
(fit.aov_4 <- aov_4(Resting ~ Treatment + (Treatment|Block), data=exp3))
y_list <- c("In_Nest", "Nursing", "Licking_Pups", "Nest_Building", "Eating.Drinking", "Grooming", "Active", "Resting")
my_table <- data.table(NULL)
exp3[, one:=1] # used for getting N in each level
exp3[, myID:=factor(1:.N)] # ID 164 is present twice
for(y in y_list){
n.mc <- sum(exp3[Treatment=="MC" & !is.na(get(y)), one])
n.lbe <- sum(exp3[Treatment=="LBE" & !is.na(get(y)), one])
fixed_i <- formula(paste(y, "Treatment", sep=" ~ "))
my_table <- rbind(my_table,
data.table(Response=y,
anova(lme(fixed_i, random = ~ 1|Block,
method="ML", data=exp3))[2,],
Mean.MC=mean(exp3[Treatment=="MC", get(y)]),
SE.MC=sd(exp3[Treatment=="MC", get(y)])/sqrt(n.mc),
Mean.LBE=mean(exp3[Treatment=="LBE", get(y)]),
SE.LBE=sd(exp3[Treatment=="LBE", get(y)])/sqrt(n.lbe)
))
}
# table is printed below the reported table
knitr::kable(my_table, digits=c(NA,0,0,2,3,2,2,2,2))
exp4 <- data.table(read_excel(file_path, range="V1:Z60"))
colnames(exp4) <- clean_label(colnames(exp4))
exp4[, Treatment:=factor(Treatment)]
head(exp4)
y
aov_car(Resting ~ Treatment + Error(Block/(Treatment)), exp3)
exp3
aov_car(Resting ~ Treatment + Block + Error(1/Block), exp3)
aov_car(Resting ~ Treatment*Block + Error(1/Block), exp3)
aov_4(Resting ~ Treatment*Block + (Treatment/Block), exp3)
aov_4(Resting ~ Treatment*Block + (1/Block), exp3)
lmer(Resting ~ Treatment*Block + (1/Block), exp3)
?lmer
lmer(Resting ~ Treatment*Block + (1|Block), exp3)
lmer(Resting ~ Treatment*Block + (Treatment|Block), exp3)
aov_4(Resting ~ Treatment*Block + (Treatment|Block), exp3)
aov_4(Resting ~ Treatment + Block + (1|Block), exp3)
aov_4(Resting ~ Treatment*Block + (1|Block), exp3)
exp4
head(exp4)
?melt
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name=Time, value.name=GCM)
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
head(exp4_long)
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp1_long))
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long))
?aov_4
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long), correction="none")
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long, correction="none"))
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long, anova_table = list(correction = "none")))
head(exp4)
library(ggplot2)
library(readxl)
library(data.table)
library(emmeans)
library(nlme)
library(lme4)
library(lmerTest)
library(afex)
data_folder <- "../data"
folder <- "Data from Perceived threats of infanticide reduce maternal allocation during lactation and lead to elevated oxidative damage in offspring"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
source("../R/clean_label.R") # bookdown
knitr_path <- TRUE
fn <- "LBE paper data.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
# exp1
exp1 <- data.table(read_excel(file_path, range="A1:E185"))
colnames(exp1) <- clean_label(colnames(exp1))
exp1[, Treatment:=factor(Treatment)]
exp2 <- data.table(read_excel(file_path, range="F1:H45"))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment:=factor(Treatment)]
exp3 <- data.table(read_excel(file_path, range="K1:U45"))
colnames(exp3) <- clean_label(colnames(exp3))
exp3[, Treatment:=factor(Treatment)]
exp4 <- data.table(read_excel(file_path, range="V1:Z60"))
colnames(exp4) <- clean_label(colnames(exp4))
exp4[, Treatment:=factor(Treatment)]
head(exp4)
(fit.aov_4 <- aov_4(Collection_1 ~ Treatment, data=exp4, anova_table = list(correction = "none")))
anova(lm(Collection_1 ~ Treatment, data=exp4))
anova(lm(Collection_1 ~ Treatment, data=exp4))
anova(lm(Collection_2 ~ Treatment, data=exp4))
anova(lm(Collection_3 ~ Treatment, data=exp4))
# melt wide to long
exp4_long <- melt(exp4, id.vars=c("ID", "Treatment"), variable.name="Time", value.name="GCM")
(fit.aov_4 <- aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long, anova_table = list(correction = "none")))
levels(exp4_long$Treatment)
aov_4(GCM ~ Treatment*Time + (Time|ID), data=exp4_long[Treatment!="UC",], anova_table = list(correction = "none"))
names(exp4_long)
raw <- exp4_long[!is.na(GCM), .(GCM=mean(GCM),
SE=sd(GCM)/sqrt(.N)), by=.(Treatment, Time)]
raw
modeled <- emmeans(fit.aov_4, specs=c("Treatment", "Time"))
modeled
raw <- exp4_long[!is.na(GCM), .(GCM=mean(GCM),
SE=sd(GCM)/sqrt(.N)), by=.(Treatment, Time)]
modeled <- summary(emmeans(fit.aov_4, specs=c("Treatment", "Time")))
pd <- position_dodge(0.5)
gg1 <- ggplot(data=raw, aes(x=Treatment, y=GCM, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=0.2, position=pd) +
NULL
gg1
pd <- position_dodge(0.5)
gg1 <- ggplot(data=raw, aes(x=Treatment, y=GCM, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=GCM-SE, ymax=GCM+SE), width=0.2, position=pd) +
NULL
gg1
pd <- position_dodge(0.5)
gg1 <- ggplot(data=raw, aes(x=Treatment, y=GCM, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=GCM-SE, ymax=GCM+SE), width=0.2, position=pd) +
co0rd_cartesian(ylim=c(0,15000)) +
NULL
pd <- position_dodge(0.5)
gg1 <- ggplot(data=raw, aes(x=Treatment, y=GCM, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=GCM-SE, ymax=GCM+SE), width=0.2, position=pd) +
coord_cartesian(ylim=c(0,15000)) +
NULL
gg1
raw <- exp4_long[!is.na(GCM), .(GCM=mean(GCM),
SE=sd(GCM)/sqrt(.N)), by=.(Treatment, Time)]
modeled <- summary(emmeans(fit.aov_4, specs=c("Treatment", "Time")))
pd <- position_dodge(0.5)
gg1 <- ggplot(data=raw, aes(x=Treatment, y=GCM, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=GCM-SE, ymax=GCM+SE), width=0.2, position=pd) +
coord_cartesian(ylim=c(0,15000)) + # this is way too much white space
NULL
gg1
gg1 <- ggplot(data=modeled, aes(x=Treatment, y=emmean, color=Time, group=Time)) +
geom_point(position=pd) +
geom_errorbar(aes(ymin=emmean-SE, ymax=emmean+SE), width=0.2, position=pd) +
coord_cartesian(ylim=c(0,15000)) + # this is way too much white space
NULL
gg1
exp5 <- data.table(read_excel(file_path, range="AA1:AJ86"))
colnames(exp5) <- clean_label(colnames(exp5))
exp5[, Treatment:=factor(Treatment)]
head(exp5)
fn <- "table2.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
names(exp5)
m1 <- lme(Liver_Thiols ~ Treatment, random = ~ 1|Block, method="ML", data=exp5)
anova(m1)
blogdown:::serve_site()
library(ggplot2)
library(readxl)
library(data.table)
library(emmeans)
library(nlme)
library(lme4)
library(lmerTest)
library(afex)
data_folder <- "../data"
folder <- "Data from Perceived threats of infanticide reduce maternal allocation during lactation and lead to elevated oxidative damage in offspring"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
source("../R/clean_label.R") # bookdown
fn <- "LBE paper data.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
# offspring weight
exp1 <- data.table(read_excel(file_path, range="A1:E185"))
colnames(exp1) <- clean_label(colnames(exp1))
exp1[, Treatment:=factor(Treatment)]
exp2 <- data.table(read_excel(file_path, range="F1:H45"))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment:=factor(Treatment)]
# maternal behavior
exp3 <- data.table(read_excel(file_path, range="K1:U45"))
colnames(exp3) <- clean_label(colnames(exp3))
exp3[, Treatment:=factor(Treatment)]
# GCMs
exp4 <- data.table(read_excel(file_path, range="V1:Z60"))
colnames(exp4) <- clean_label(colnames(exp4))
exp4[, Treatment:=factor(Treatment)]
#oxidative stress
exp5 <- data.table(read_excel(file_path, range="AA1:AJ86"))
colnames(exp5) <- clean_label(colnames(exp5))
exp5[, Treatment:=factor(Treatment)]
exp1[, ID:=factor(1:nrow(exp1))]
exp1[, Treatment:=factor(Treatment, c("MC", "LBE"))]
exp1[, Sex:=factor(Sex)]
exp1_long <- melt(exp1, id.vars = c("Treatment", "Sex", "ID"), variable.name="Time", value.name = "Weight")
exp1_long[, ID:=factor(ID)]
#(fit.aov_car <- aov_car(Weight ~ Treatment*Sex*Time + Error(ID/Time), data=exp1_long))
#(fit.ez <- aov_ez("ID", "Weight", exp1_long, between=c("Treatment", "Sex"), within="Time"))
(fit.aov_4 <- aov_4(Weight ~ Treatment*Sex*Time + (Time|ID), data=exp1_long))
# linear mixed model "version" of repeated measures ANOVA
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
coef(summary(fit.lme))
# model III anova
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
#fit.lmer <- lmer(Weight ~ Treatment*Sex*Time + (1|ID) + (1|ID:Time), data=exp1_long, REML = FALSE)
#anova(fit.lmer, type="marginal")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
# simpler, better way of measuring growth rate differences
fit1 <- lm(weaning ~ birth + Treatment*Sex, data=exp1)
coef(summary(fit1))
fit2 <- lm(adulthood ~ birth + Treatment*Sex, data=exp1)
coef(summary(fit2))
# plot
fit.emm <- data.table(summary(emmeans(fit.lme, specs=c("Treatment", "Sex", "Time"))))
setnames(fit.emm, old="emmean", new="Weight")
pd <- position_dodge(0.5)
gg <- ggplot(data=exp1_long, aes(x=Treatment, y=Weight, color=Time)) +
#geom_point(position=pd) +
geom_point(data=fit.emm, aes(x=Treatment, y=Weight), position=pd)+
geom_errorbar(data=fit.emm, aes(x=Treatment, ymin=lower.CL, ymax=upper.CL), position=pd, width=0.2) +
facet_grid(.~Sex) +
NULL
gg
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
#fit.lmer <- lmer(Weight ~ Treatment*Sex*Time + (1|ID) + (1|ID:Time), data=exp1_long, REML = FALSE)
#anova(fit.lmer, type="marginal")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
fit.lmer <- lmer(Weight ~ Treatment*Sex*Time + (1|ID) + (1|ID:Time), data=exp1_long, REML = FALSE)
fit.lmer <- lmer(Weight ~ Treatment*Sex + (1|ID) + (1|ID:Time), data=exp1_long, REML = FALSE)
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
fit.lme <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(fit.lme, type="marginal")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "REML")
anova(m2, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
m4 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = TRUE)
anova(m4, type="marginal")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
fit.emm <- data.table(summary(emmeans(fit.lme, specs=c("Treatment", "Sex", "Time"))))
setnames(fit.emm, old="emmean", new="Weight")
pd <- position_dodge(0.5)
gg <- ggplot(data=exp1_long, aes(x=Treatment, y=Weight, color=Time)) +
#geom_point(position=pd) +
geom_point(data=fit.emm, aes(x=Treatment, y=Weight), position=pd)+
geom_errorbar(data=fit.emm, aes(x=Treatment, ymin=lower.CL, ymax=upper.CL), position=pd, width=0.2) +
facet_grid(.~Sex) +
NULL
gg
# model III anova
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long)
anova(m2, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
m4 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = TRUE)
anova(m4, type="marginal")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
fit.aov_4
exp1_long[!is.na(Weight), .(N=.N), by=.(Treatment, Sex, Time)]
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
Anova(lm(Weight ~ Treatment*Sex*Time, data=exp1_long), type="3")
library(car)
# model III anova
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
Anova(lm(Weight ~ Treatment*Sex*Time, data=exp1_long), type="3")
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
Anova(lm(Weight ~ Treatment*Sex*Time, data=exp1_long), type="3")
aov(Weight ~ Treatment*Sex*Time, data=exp1_long)
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m3 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m3, type="marginal")
Anova(lm(Weight ~ Treatment*Sex*Time, data=exp1_long), type="3")
summary(aov(Weight ~ Treatment*Sex*Time, data=exp1_long))
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lmer(Weight ~ Treatment*Sex*Time + (Time|ID), data=exp1_long, REML = FALSE)
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lmer(Weight ~ Treatment*Sex*Time + (Time|ID), data=exp1_long, REML = FALSE)
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m2, type="marginal")
m1 <- lme(Weight ~ Treatment*Sex, random = ~ Time|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lmer(Weight ~ Treatment*Sex + (Time|ID), data=exp1_long, REML = FALSE)
contrasts(exp1_long$Treatment) <- contr.sum
contrasts(exp1_long$Sex) <- contr.sum
m1 <- lme(Weight ~ Treatment*Sex*Time, random = ~ 1|ID, data=exp1_long, method = "ML")
anova(m1, type="marginal")
m2 <- lmer(Weight ~ Treatment*Sex*Time + (1|ID), data=exp1_long, REML = FALSE)
anova(m2, type="marginal")
# fixed effects only
# using linear model
Anova(lm(Weight ~ Treatment*Sex*Time, data=exp1_long), type="3")
# classical ANOVA
summary(aov(Weight ~ Treatment*Sex*Time, data=exp1_long))
contrasts(exp1_long$Treatment) <- contr.treatment
contrasts(exp1_long$Sex) <- contr.treatment
fit.aov_4
fit.emm <- data.table(summary(emmeans(fit.lme, specs=c("Treatment", "Sex", "Time"))))
setnames(fit.emm, old="emmean", new="Weight")
pd <- position_dodge(0.5)
gg <- ggplot(data=exp1_long, aes(x=Treatment, y=Weight, color=Time)) +
#geom_point(position=pd) +
geom_point(data=fit.emm, aes(x=Treatment, y=Weight), position=pd)+
geom_errorbar(data=fit.emm, aes(x=Treatment, ymin=lower.CL, ymax=upper.CL), position=pd, width=0.2) +
facet_grid(.~Sex) +
NULL
gg
blogdown:::serve_site()
2^10
2^10
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
2500*4184/24/3600
