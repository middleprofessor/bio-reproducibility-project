# anova(fit1)
shoot <- shoot[CAGE_TREAT!="uncaged"]
shoot$wind_fetch
fit1 <- lm(sqrt(ShootDW_g) ~ Actual_Retention_time + wind_fetch + CAGE_TREAT * DENSITY_TREAT * NUTRIENT_TREAT, data=shoot)
anova(fit1)
fit1 <- lmer(sqrt(ShootDW_g) ~ Actual_Retention_time + wind_fetch + CAGE_TREAT*DENSITY_TREAT*NUTRIENT_TREAT + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
#
# fit1 <- lmer(sqrt(ShootDW_g) ~ Actual_Retention_time + wind_fetch + CAGE_TREAT*DENSITY_TREAT*NUTRIENT_TREAT + (1|CAGE_ID), data=shoot, REML=FALSE)
# anova(fit1)
fit1 <- lmer(sqrt(ShootDW_g) ~ Actual_Retention_time + wind_fetch + CAGE_TREAT*DENSITY_TREAT*NUTRIENT_TREAT + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
fit1 <- lmer(sqrt(ShootDW_g) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
str(shoot)
str(shoot)
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
fit2 <- lmer(sqrt(Sum_branch_length) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit2)
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit1)
fit2 <- lmer(sqrt(Sum_branch_length) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit2)
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit1)
anova(fit1, ddf="Kenward-Roger")
fit2 <- lmer(sqrt(Sum_branch_length) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit2)
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit1)
anova(fit1, ddf="Kenward-Roger")
anova(fit1, ddf="lme4")
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit1)
anova(fit1, ddf="Kenward-Roger")
anova(fit1, ddf="lme4")
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
anova(fit1, ddf="Kenward-Roger")
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=TRUE)
anova(fit1)
anova(fit1, ddf="Kenward-Roger")
anova(fit1, ddf="lme4")
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
anova(fit1, ddf="lme4")
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
fit1 <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (SITE|CAGE_ID), data=shoot, REML=FALSE)
anova(fit1)
library(nlme)
?lme
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, REML=FALSE)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
anova(fit1)
fit1.lmer <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit1.lmer)
fit2 <- lmer(sqrt(Sum_branch_length) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit2)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
anova(fit1)
# compare with lmer
fit1.lmer <- lmer(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot)
anova(fit1.lmer)
fit2 <- lmer(sqrt(Sum_branch_length) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time + (1|SITE) + (1|SITE:CAGE_ID), data=shoot, REML=FALSE)
anova(fit2)
str(shoot)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
shoot$scaled_Strictly_epiphytic_algae_DW_g_Myrio
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
anova(fit5)
?merge
merge(fit1.anova, fit2.anova, by=0)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
df <- merge(fit1.anova, fit2.anova, by=0)
df
fit1.anova
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df
df <- merge(df, fit3.anova[, ycols], by=0)
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- merge(df, fit3.anova[, ycols], by=Row.names)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- merge(df, fit3.anova[, ycols], by="Row.names")
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-"Row.names"]
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
df
row.names(df)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- merge(df, fit3.anova[, ycols], by=0)
df
df
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df
row.names(df)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df[,-1]
row.names(df) <- row.names(fit1.anova)
df
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0)
names(df)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
df
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
fn <- "tableS1.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
knitr_path
knitr_path <- TRUE
fn <- "tableS1.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
fit1.anova
fit1.anova
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0, sort=FALSE)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
?lme
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML")
fit1.anova <- anova(fit1)
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2)
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3)
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4)
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5)
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0, sort=FALSE)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML")
anova(fit1)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
anova(fit1)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML")
anova(fit1)
fit1 <- lme(sqrt(N_tot_branches) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
anova(fit1)
fit1 <- lme(sqrt(N_tot_branches) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML")
anova(fit1)
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML"))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|CAGE_ID, data=shoot, method="ML"))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML"))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~SITE|CAGE_ID, data=shoot, method="ML"))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML"))
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|CAGE_ID/SITE, data=shoot, method="ML"))
anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, method="ML"))
library(car)
anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
Anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
?Anova
anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot))
Anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type="3")
con3 <- list(DENSITY_TREAT=contr.sum, CAGE_TREAT=contr.sum, NUTRIENT_TREAT=contr.sum)
Anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, contrasts=con3), type="3")
anova(lme(sqrt(Max_length_cm) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, type = "marginal")
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1, type = "marginal")
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2, type = "marginal")
fit3 <- lme(sqrt(N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3, type = "marginal")
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4, type = "marginal")
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5, type = "marginal")
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0, sort=FALSE)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
?kable
anova(lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
names(shoot)
anova(lme(ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
shoot[, plant_mass <- ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude), type = "marginal")
anova(lme(sqrt(ShootDW_g) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude), type = "marginal")
#shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
#anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, #data=shoot, na.action=na.exclude), type = "marginal")
anova(lme(sqrt(ShootDW_g) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")
#shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
#anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, #data=shoot, na.action=na.exclude), type = "marginal")
anova(lme(sqrt(ShootDW_g) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")["DENSITY_TREAT",]
#shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
#anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, #data=shoot, na.action=na.exclude), type = "marginal")
anova(lme(sqrt(ShootDW_g) ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot), type = "marginal")["DENSITY_TREAT",]
shoot[, plant_mass:=ShootDW_g+Strictly_epiphytic_algae_DW_g_Myrio]
anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude), type = "marginal")["DENSITY_TREAT",]
shoot[, plant_mass:=ShootDW_g-Strictly_epiphytic_algae_DW_g_Myrio]
anova(lme(plant_mass ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude), type = "marginal")["DENSITY_TREAT",]
Strictly_epiphytic_algae_DW_g_Myrio
str(shoot)
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1, type = "marginal")
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2, type = "marginal")
fit3 <- lme((N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3, type = "marginal")
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4, type = "marginal")
fit5 <- lme(sqrt(Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5, type = "marginal")
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0, sort=FALSE)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
fit1 <- lme(ShootDW_g ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit1.anova <- anova(fit1, type = "marginal")
fit2 <- lme(sqrt(Sum_branch_length)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit2.anova <- anova(fit2, type = "marginal")
fit3 <- lme((N_tot_branches)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit3.anova <- anova(fit3, type = "marginal")
fit4 <- lme(sqrt(Max_length_cm)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot)
fit4.anova <- anova(fit4, type = "marginal")
fit5 <- lme(sqrt(scaled_Strictly_epiphytic_algae_DW_g_Myrio)  ~ DENSITY_TREAT*CAGE_TREAT*NUTRIENT_TREAT + wind_fetch + Actual_Retention_time, random = ~1|SITE/CAGE_ID, data=shoot, na.action=na.exclude)
fit5.anova <- anova(fit5, type = "marginal")
ycols <- c("F-value", "p-value")
df <- merge(fit1.anova, fit2.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit3.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit4.anova[, ycols], by=0, sort=FALSE)
df <- df[,-1]
row.names(df) <- row.names(fit1.anova)
df <- merge(df, fit5.anova[, ycols], by=0, sort=FALSE)
colnames(df) <- c("Term", "numDF", "denDF", "Plant biomass F", "Plant biomass p", "Branch length F", "Branch length p", "N branches F", "N branches p", "Stem length F", "Stem length p", "Algae biomass F", "Algae biomass p")
knitr::kable(df, digits=c(NA, 0, 0, 2, 3, 2, 3, 2, 3, 2, 3, 2, 3))
frb
frb
frb
frb5.emm <- summary(emmeans(frb5.fit, specs="treatment"))
frb5.emm <- summary(emmeans(frb5.fit, specs="treatment"))
frb5.emm
frb5.emm <- summary(emmeans(frb5.fit, specs=c("treatment", "season")))
frb5.emm
library(readxl)
library(ggplot2)
library(data.table)
library(emmeans)
library(lmerTest)
library(nlme)
library(ggpubr)
data_folder <- "../data"
folder <- "Data from Frequency of virus-resistant hosts determines experimental community dynamics"
fn <- "Coloma DATA.xlsx"
file_path <- paste(data_folder, folder, fn, sep="/")
# for working use =TRUE, for final html use =FALSE
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE
images_folder <- "../images" # for working and not final html
pre_process_data <- function(dt_in, wide=FALSE){
# takes the raw imported sheet and process it for analysis
# output is long format if wide = FALSE
dt <- copy(dt_in)
# set column names
col_labels <- c("native", "id", "0", "0.5", as.character(1:20))
setnames(dt, old=colnames(dt), new=col_labels)
# add Nitrogen column by guessing
dt[, N:=rep(rep(c("N_lim", "N_rich"), each=4), 2)]
# cull 99.5% rows
dt <- dt[native!=99.5]
# make column of 1 - native for frequency of phage-resistant Nodularia
dt[, resistant:=100-native]
# make resistant and Nitrogen factors
dt[, resistant:=factor(resistant)]
dt[, N:=factor(N)]
# limit to weeks 0, 2,4 6, 8, 12, 20, need week zero for plots
ycols <- as.character(c(0, 2, 4, 6, 8, 12, 20))
if(wide==TRUE){
dt_out <- dt[, .SD, .SDcols=c("resistant", "id", "N", ycols)]
}else{ #long format
dt_out <- melt(dt,
id.vars=c("resistant", "id", "N"),
measure.vars=ycols,
variable.name="week",
value.name="count")
}
return(dt_out)
}
# phage
sheet_i <- "Phage"
range_i <- "A3:X34" # ignores labels as the first two columns have none
phage <- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
phage_long <- pre_process_data(phage)
sheet_i <- "Rotifers"
range_i <- "A5:X36" # skip double header and read only to week 20
rotifers <- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
rotifers_long <- pre_process_data(rotifers)
sheet_i <- "Chlorella"
range_i <- "A4:X35" # skip double header and read only to week 20
# add first two columns as in other three
chlorella <- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
chlorella_long <- pre_process_data(chlorella)
sheet_i <- "Nodularia"
range_i <- "A5:V36" # skip double header and read only to week 20
nodularia_part <- data.table(read_excel(file_path, sheet=sheet_i, range=range_i, col_names=FALSE))
# change colnames so not duplicate
colnames(nodularia_part) <- paste("X",1:22,sep="")
nodularia <- cbind(phage[, 1:2], nodularia_part)
nodularia_long <- pre_process_data(nodularia)
summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=nodularia_long[week!=0]))
summary(aov(count ~ N + Error(id), phage_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=phage_long[week!=0]))
summary(aov(count ~ N + Error(id), chlorella_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=chlorella_long[week!=0]))
summary(aov(count ~ N + Error(id), rotifers_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=rotifers_long[week!=0]))
stats <- c("Df2", "F value1", "Pr(>F)1")
aov1 <- unlist(summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$"Error: id")[stats]
aov2 <- unlist(summary(aov(count ~ N + Error(id), phage_long[week!=0]))$"Error: id")[stats]
aov3 <- unlist(summary(aov(count ~ N + Error(id), chlorella_long[week!=0]))$"Error: id")[stats]
aov4 <- unlist(summary(aov(count ~ N + Error(id), rotifers_long[week!=0]))$"Error: id")[stats]
table_1 <- data.table(component=c("Nodularia", "Phage", "Chlorella", "Rotifer"),
rbind(aov1, aov2, aov3, aov4))
setnames(table_1, old=colnames(table_1), new=c("component", "DDF", "F", "p"))
knitr::kable(table_1, digits=c(NA, 0, 3, 3))
summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=nodularia_long[week!=0]))
anova(lme(count ~ N, random = ~1|id, data=nodularia_long[week!=0]))
summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=nodularia_long[week!=0]))
anova(lme(count ~ N, random = ~1|id, data=nodularia_long[week!=0]), na.action=na.exclude())
?lme
summary(aov(count ~ N + Error(id), nodularia_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=nodularia_long[week!=0]))
anova(lme(count ~ N, random = ~1|id, data=nodularia_long[week!=0], na.action=na.exclude))
summary(aov(count ~ N + Error(id), phage_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=phage_long[week!=0]))
summary(aov(count ~ N + Error(id), chlorella_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=chlorella_long[week!=0]))
summary(aov(count ~ N + Error(id), rotifers_long[week!=0]))$"Error: id"
anova(lmer(count ~ N + (1|id), data=rotifers_long[week!=0]))
