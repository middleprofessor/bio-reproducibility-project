exp2[is.na(Behaviour_upon_acceptance_offer_2), Behaviour_upon_acceptance_offer_2:="NA"]
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[!is.na(Rejects_in_offer_2), R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
m2 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
anova(m2, m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
anova(m1, m2, test="Chisq")
anova(m2, m1)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Land"])
drop1(m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
m2 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
anova(m1, m2, test="Chisq")
anova(m1)
anova(m1, test="Chisq")
?anova.glm
anova(m1, test="LRT")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
m3 <- glm(R1 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
anova(m1, m3, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
library(car)
Anova(m1, type="3")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
Anova(m1, type="3")
anoa(m1)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
Anova(m1, type="3")
anova(m1)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
Anova(m1, type="3")
anova(m1, test="Chisq")
Anova(m1, type="2")
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[!is.na(Rejects_in_offer_2), R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2[Behaviour_upon_acceptance_offer_2!="Feed"])
drop1(m1, test="Chisq")
Anova(m1, type="2")
anova(m1, test="Chisq")
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
drop1(m1, test="Chisq")
anova(m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
drop1(m1, test="Chisq")
anova(m1, test="Chisq")
head(exp1)
head(exp2)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
drop1(m1, test="Chisq")
Anova(m1, type="3")
anova(m1, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
anova(m1, type="marginal")
#m2=update(m1,~.-gender:musict1:picturest1)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
Anova(m1, type="3")
#m2=update(m1,~.-gender:musict1:picturest1)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Day)
anova(m1, m2)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Day)
anova(m1, m2, test="Chisq")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Day)
anova(m1, m2, test="Chisq")
Anova(m1, type="2")
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3=update(m2,~.-Treatment_2:Day)
m3=update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4=update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5=update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m6, m67, test="Chisq")
anova(m6, m7, test="Chisq")
Anova(m7)
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m6, m7, test="Chisq")
Anova(m7)
sheet_2 <- "Experiment 2"
exp2 <- data.table(read_excel(file_path, sheet=sheet_2))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment_1:=factor(Treatment_1)]
exp2[, Treatment_2:=factor(Treatment_2)]
exp2[, Day_fac:=factor(Day)] # create a new column with day as factor
# "NA" in $Rejects_in_offer_2$ is probably "not accepted" and not missing
# this will convert these to missing, so think about how this effects subsequent analysis
exp2[, Rejects_in_offer_2:=as.numeric(Rejects_in_offer_2)]
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
exp2$Behaviour_upon_acceptance_offer_2
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
m1 <- glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m6, m7, test="Chisq")
head(exp2)
"Rejects_in_offer_2"
exp2$Rejects_in_offer_2
exp2[, R1.1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA" | Rejects_in_offer_2 > 0,0,1)]
exp2[R1.1==1, R2.1:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
head(exp2)
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m6, m7, test="Chisq")
# Again "NA" is probably "not accepted". But there is one missing value assigned NA. is this "NA" or truly missing?
which_na <- is.na(exp2$Behaviour_upon_acceptance_offer_2)
exp2[which_na, Behaviour_upon_acceptance_offer_2:="NA"]
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
exp2[, R1.1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA" | Rejects_in_offer_2 > 0,0,1)]
exp2[R1.1==1, R2.1:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m6, m7, test="Chisq")
m5
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq")
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m5,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
m7
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m8)
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m8, test="Chisq")
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m7, test="Chisq")
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m7, test="Chisq")
anova(glm(R1.1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2))
anova(glm(R1.1 ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2))
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m7, test="Chisq")
anova(glm(R1.1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1.1 ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
head(exp2)
head(exp2)
anova(glm(R2.1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1 ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2$R2.1
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2$R2.1b
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="Land" | Rejects_in_offer_2, 0, 1)]
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="Land" | Rejects_in_offer_2 > 0, 0, 1)]
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2[, R1.1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA" | Rejects_in_offer_2 > 0,0,1)]
exp2[R1.1==1, R2.1:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="Land" | Rejects_in_offer_2 > 0, 0, 1)]
exp2$R2.1
exp2$R2.1b
exp2$R1.1
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="NA"  | Behaviour_upon_acceptance_offer_2=="Land" | Rejects_in_offer_2 > 0, 0, 1)]
exp2$R2.1b
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1 ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] #subset
exp2[, R2b:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] # v NA + Land
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day + Treatment_2:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1*Treatment_2*Day), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1*Treatment_2*Day, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1*Day*Treatment_2, data=exp2), test="Chisq")
anova(glm(R2b ~ Day*Treatment_2*Treatment_1, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day + Treatment_2:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
fn <- "table2.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
exp2 <- data.table(read_excel(file_path, sheet=sheet_2))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment_1:=factor(Treatment_1)]
exp2[, Treatment_2:=factor(Treatment_2)]
exp2[, Day_fac:=factor(Day)] # create a new column with day as factor
exp2
# Again "NA" is probably "not accepted". But there is one missing value assigned NA. is this "NA" or truly missing?
which_na <- is.na(exp2$Behaviour_upon_acceptance_offer_2)
exp2[which_na, Behaviour_upon_acceptance_offer_2:="NA"]
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
which_na
which_na
which_na <- which(is.na(exp2$Behaviour_upon_acceptance_offer_2))
which_na
sheet_2 <- "Experiment 2"
exp2 <- data.table(read_excel(file_path, sheet=sheet_2))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment_1:=factor(Treatment_1)]
exp2[, Treatment_2:=factor(Treatment_2)]
exp2[, Day_fac:=factor(Day)] # create a new column with day as factor
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] #subset
exp2[, R2b:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] # v NA + Land
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
exp2[, R1.1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA" | Rejects_in_offer_2 > 0,0,1)]
exp2[R1.1==1, R2.1:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)]
exp2[, R2.1b:=ifelse(Behaviour_upon_acceptance_offer_2=="NA"  | Behaviour_upon_acceptance_offer_2=="Land" | Rejects_in_offer_2 > 0, 0, 1)]
# R2.1b reproduces
m1 <- glm(R1.1 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 + Treatment_1:Day + Treatment_2:Day + Treatment_1:Treatment_2:Day, family=binomial, data=exp2)
m2=update(m1,~.-Treatment_1:Treatment_2:Day)
anova(m1, m2, test="Chisq") # remove Treatment_1:Treatment_2:Day from model
m3 <- update(m2,~.-Treatment_2:Day)
anova(m2, m3, test="Chisq")
m4 <- update(m3,~.-Treatment_1:Day)
anova(m3, m4, test="Chisq")
m5 <- update(m3,~.-Treatment_1:Treatment_2)
anova(m3, m5, test="Chisq")
m6 <- update(m5,~.-Treatment_1:Day)
anova(m5, m6, test="Chisq")
m7 <- update(m5,~.-Treatment_2)
anova(m5, m7, test="Chisq")
m8 <- update(m7,~.-Treatment_1:Day)
anova(m7, m8, test="Chisq")
anova(m7, test="Chisq")
anova(glm(R1.1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R1.1 ~ Day + Treatment_1 + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2.1b ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
levels(exp2$Behaviour_upon_acceptance_offer_2)
which(is.na(exp2$Behaviour_upon_acceptance_offer_2))
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
sheet_2 <- "Experiment 2"
exp2 <- data.table(read_excel(file_path, sheet=sheet_2))
colnames(exp2) <- clean_label(colnames(exp2))
exp2[, Treatment_1:=factor(Treatment_1)]
exp2[, Treatment_2:=factor(Treatment_2)]
exp2[, Day_fac:=factor(Day)] # create a new column with day as factor
# Again "NA" is probably "not accepted". But there is one missing value assigned NA. is this "NA" or truly missing?
which_na <- which(is.na(exp2$Behaviour_upon_acceptance_offer_2))
# copy column which will leave the value as missing
exp2[, Behaviour_upon_acceptance_offer_2.na:=Behaviour_upon_acceptance_offer_2]
# change value in original column to "NA"
exp2[which_na, Behaviour_upon_acceptance_offer_2:="NA"]
# make both columns factors
exp2[, Behaviour_upon_acceptance_offer_2:=factor(Behaviour_upon_acceptance_offer_2)]
exp2[, Behaviour_upon_acceptance_offer_2.na:=factor(Behaviour_upon_acceptance_offer_2.na)]
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] #subset
exp2[, R2b:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] # v NA + Land
exp2[Rejects_in_offer_2 != "NA", R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
# recoded as "NA"
anova(glm(R1 ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
# left as missing
exp2[, R1.na:=ifelse(Behaviour_upon_acceptance_offer_2.na=="NA",0,1)]
anova(glm(R1.na ~ Treatment_1 + Day + Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
anova(glm(R2b ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2 +
Treatment_1:Day, family=binomial, data=exp2), test="Chisq")
# with missing value recoded as "NA"
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
# with missing value recoded as "NA"
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
anova(glm(R3 ~ Treatment_2 + Treatment_1 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
exp2$Rejects_in_offer_2
exp2$Rejects_in_offer_2
# "NA" in $Rejects_in_offer_2$ is probably "not accepted" and not missing
# this will convert these to missing, so think about how this effects subsequent analysis
exp2[, Rejects_in_offer_2:=as.numeric(Rejects_in_offer_2)]
exp2$Rejects_in_offer_2
exp2[, R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
exp2$R3
# with missing value recoded as "NA"
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Day + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
exp2$R3
exp2$Rejects_in_offer_1
exp2$Rejects_in_offer_2
exp2[, R3:=ifelse(is.na(R3),11,R3)]
exp2$R3
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
exp2[, R3:=ifelse(if(R3==11),1,R3)]
exp2[, R3:=ifelse(R3==11,1,R3)]
anova(glm(R3 ~ Treatment_1 + Treatment_2 + Treatment_1:Treatment_2, family=binomial, data=exp2), test="Chisq")
exp2[, R1:=ifelse(Behaviour_upon_acceptance_offer_2=="NA",0,1)]
exp2[R1==1, R2:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] #subset
exp2[, R2b:=ifelse(Behaviour_upon_acceptance_offer_2=="Feed", 1, 0)] # v NA + Land
exp2[, R3:=ifelse(Rejects_in_offer_2 > Rejects_in_offer_1, 1, 0)]
exp2[, Rejects_in_offer_2]
head(exp2)
exp2$R1
exp2$R1
exp2$R1.na
spider <- c(test1b["Spider_binary", "LRT"], test2b["Spider_binary", "LRT"], test3b["Spider_binary", "LRT"])
flower <- c(test1b["Flower", "LRT"], test2b["Flower", "LRT"], test3b["Flower", "LRT"])
inter <- c(test1a["Flower:Spider_binary", "LRT"], test2a["Flower:Spider_binary", "LRT"], test3a["Flower:Spider_binary", "LRT"])
responses <- c("Accepted v not accepted","Accepted v rejected", "Inspected v not inspected")
table1 <- data.table(Response=responses,
Spider=spider,
Flower=flower,
Interaction=inter)
knitr::kable(table1, digits=c(NA, 3, 3, 3))
fn <- "table1.png"
if(knitr_path==TRUE){
image_path <- paste("../images", folder, fn, sep="/")
}else{
image_path <- paste("/images", folder, fn, sep="/")
}
knitr::include_graphics(image_path)
