p_values[3] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 1"|treatment=="W"])$p.value
p_values[4] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 1"|treatment=="HW"])$p.value
p_values[5] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 5"|treatment=="H 20"])$p.value
p_values[6] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 5"|treatment=="W"])$p.value
p_values[7] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 5"|treatment=="HW"])$p.value
p_values[8] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 20"|treatment=="W"])$p.value
p_values[9] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="H 20"|treatment=="HW"])$p.value
p_values[10] <- t.test(log(NH4.no0) ~ treatment, var.equal=var_equal, data=dissolution[treatment=="W"|treatment=="HW"])$p.value
p.adjust(p_values, "holm")
fn <- "Subalusky_2018_mara_nutrient_limitation_assays.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
limit <- fread(file_path)
head(limit)
R_11.fit <- lm(CR.corr.no0 ~ treatment*site, data=limit[year=="2011"])
CR.corr.no0
R_11.fit <- lm(CR.corr.no0 ~ treatment*site, data=limit[year=="2011"])
aov(R_11.fit)
R_11.fit <- lm(CR.corr.no0 ~ treatment*site, data=limit[year=="2011"])
summary(aov(R_11.fit))
unique(limit$site)
unique(limit$substrate)
# heterotrophic: substrate = "Sponge"
R_11.fit <- lm(sqrt(CR.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(R_11.fit))
# heterotrophic: substrate = "Sponge"
R_hetero_Y11.fit <- lm(sqrt(CR.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(R_hetero_Y11.fit))
R_hetero_Y13.fit <- lm(sqrt(CR.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(R_hetero_Y13.fit))
unique(limit$site)
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(R_hetero_Y11.fit))
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(m1))
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site="Site 1"])
head(limit)
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 1"])
summary(aov(m1))
TukeyHSD(m1)
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 1"])
summary(aov(m1))
TukeyHSD(aov(m1))
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
# nutrients added to agar cup; Ctl: control, C: carbon (only measured in 2013), H: ammonium, N: nitrate, P: phosphate, HP: ammonium + phosphate, NP: nitrate + phosphate
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 1"])
summary(aov(m1))
TukeyHSD(aov(m1))$treatment[c("HP-Ctl", "NP-Ctl"),]
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
# nutrients added to agar cup; Ctl: control, C: carbon (only measured in 2013), H: ammonium, N: nitrate, P: phosphate, HP: ammonium + phosphate, NP: nitrate + phosphate
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 1"])
summary(aov(m1))
TukeyHSD(aov(m1))$treatment[c("HP-Ctl", "NP-Ctl"),]
TukeyHSD(aov(m1))$treatment[,]
# site key: Site 1="no wildlife", Site 2="Hippo", Site 3="Hippo + wildebeast"
# nutrients added to agar cup; Ctl: control, C: carbon (only measured in 2013), H: ammonium, N: nitrate, P: phosphate, HP: ammonium + phosphate, NP: nitrate + phosphate
m1 <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 1"])
summary(aov(m1))
TukeyHSD(aov(m1))$treatment[c("HP-Ctl", "NP-Ctl"),]
TukeyHSD(aov(m1))$treatment[c("H-Ctl", "N-Ctl", "P-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2013" & substrate=="Sponge" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("HP-Ctl", "NP-Ctl"),]
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "N-Ctl", "P-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2013" & substrate=="Sponge" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "HP-Ctl", "P-Ctl"),]
TukeyHSD(aov(fit))$treatment[c("N-Ctl", "NP-Ctl"),]
TukeyHSD(aov(fit))$treatment
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2013" & substrate=="Sponge" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("Ctl-C", "HP-Ctl", "P-Ctl"),]
TukeyHSD(aov(fit))$treatment[c("N-Ctl", "NP-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 2"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("Ctl-C", "HP-Ctl", "P-Ctl"),]
TukeyHSD(aov(fit))$treatment
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 2"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 2"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2013" & substrate=="Sponge" & site=="Site 2"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Sponge" & site=="Site 3"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
fit <- lm(sqrt(CR.corr.no0) ~ treatment, data=limit[year=="2013" & substrate=="Sponge" & site=="Site 3"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
head(limit)
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(R_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(R_hetero_Y13.fit))
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y13.fit))
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011"])
summary(aov(Chlor_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y13.fit))
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y13.fit))
unique(limit$substrate)
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Glass"])
summary(aov(Chlor_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Sponge"])
summary(aov(Chlor_hetero_Y13.fit))
Chlor_hetero_Y11.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2011" & substrate=="Glass"])
summary(aov(Chlor_hetero_Y11.fit))
Chlor_hetero_Y13.fit <- lm(sqrt(Chl.corr.no0) ~ treatment*site, data=limit[year=="2013" & substrate=="Glass"])
summary(aov(Chlor_hetero_Y13.fit))
fit <- lm(sqrt(Chl.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Glass" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))
fit <- lm(sqrt(Chl.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Glass" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))
fit <- lm(sqrt(Chl.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Glass" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment["H-Ctl",]
fit <- lm(sqrt(Chl.corr.no0) ~ treatment, data=limit[year=="2011" & substrate=="Glass" & site=="Site 1"])
summary(aov(fit))
TukeyHSD(aov(fit))$treatment[c("H-Ctl", "P-Ctl", "N-Ctl", "HP-Ctl", "NP-Ctl"),]
fn <- "Subalusky_2018_mara_river_biofilm_summary_data.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
ecosystem <- fread(file_path)
head(ecosystem)
fn <- "Subalusky_2018_mara_experimental_stream_tiles.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
ecosystem <- fread(file_path)
head(ecosystem)
?lme
library(readxl)
library(ggplot2)
library(ggpubr)
library(nlme)
library(lmerTest)
library(car)
library(emmeans)
library(data.table)
library(lmtest) #?
library(predictmeans)
data_folder <- "../data"
folder <- "Data from Density-dependent positive feedbacks buffer aquatic plants from interactive effects of eutrophication and predator loss"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE
fn <-"plant_grazer_data_SDonadi.xlsx"
# open sheet "shoot level"
sheet_i <- "Shoot level"
file_path <- paste(data_folder, folder, fn, sep='/')
shoot <- data.table(read_excel(file_path, sheet = sheet_i))
shoot <- shoot[CAGE_TREAT!="uncaged"] # Delete CAGE_TREAT="uncaged" as these are not in main analysis
shoot[, SITE:=factor(SITE)]
shoot[, CAGE_ID:=factor(CAGE_ID)]
shoot[, CAGE_TREAT:=factor(CAGE_TREAT)]
shoot[, DENSITY_TREAT:=factor(DENSITY_TREAT)]
shoot[, NUTRIENT_TREAT:=factor(NUTRIENT_TREAT)]
# open sheet "cage level"
sheet_i <- "Cage level"
file_path <- paste(data_folder, folder, fn, sep='/')
cage <- data.table(read_excel(file_path, sheet = sheet_i))
cage <- cage[CAGE_TREAT!="uncaged"] # Delete CAGE_TREAT="uncaged" as these are not in main analysis
cage[, SITE:=factor(SITE)]
cage[, CAGE_ID:=factor(CAGE_ID)]
cage[, CAGE_TREAT:=factor(CAGE_TREAT)]
cage[, DENSITY_TREAT:=factor(DENSITY_TREAT)]
cage[, NUTRIENT_TREAT:=factor(NUTRIENT_TREAT)]
library(broom)
library(ggplot2)
library(ggpubr)
library(data.table)
library(readxl)
library(nlme)
library(emmeans)
data_folder <- "../data"
folder <- "Data from Organic matter and nutrient inputs from large wildlife influence ecosystem function in the Mara River, Africa"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
data_folder <- "../data"
folder <- "Data from Organic matter and nutrient inputs from large wildlife influence ecosystem function in the Mara River, Africa"
# images need to be moved to /static/images/data from.../image.png
knitr_path <- FALSE # run = TRUE to debug
knitr_path <- TRUE
source("../R/clean_label.R") # bookdown
# dissolution rates
fn <- "Subalusky_2018_mara_nutrient_dissolution_chambers.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
dissolution <- fread(file_path)
dissolution[, treatment:=factor(treatment, c("H 1", "H 5", "H 20", "W", "HW"))]
# decomposition rates
fn <- "Subalusky_2018_mara_hippo_feces_decomp_litterbags.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
decomp <- fread(file_path)
colnames(decomp) <- clean_label(colnames(decomp))
# treatment	=	experimental treatment, where A: 40 g fresh hippo feces; B: 10 g aged hippo feces; C: 10 g aged hippo feces + 20 g wildebeest tissue
decomp[, treatment_recode:=ifelse(treatment=="A", "fresh",
ifelse(treatment=="B", "aged", "wb"))]
decomp[, treatment_recode:=factor(treatment_recode, c("fresh", "aged", "wb"))]
# nutrient limitation
fn <- "Subalusky_2018_mara_nutrient_limitation_assays.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
limit <- fread(file_path)
# Ecosystem function
# note there is another file with the raw data. This is the file of means from that file.
fn <- "Subalusky_2018_mara_experimental_stream_tiles.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
ecosystem <- fread(file_path)
fit <- lme(log(GPP.no0) ~ treatment, random = ~1|id, data=ecosystem)
head(ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, data=ecosystem, correlation=corAR1())
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, data=ecosystem, correlation=corAR1())
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, data=ecosystem, correlation=corAR1(days))
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, data=ecosystem, correlation=corAR1())
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, data=ecosystem, correlation=corAR1(form = days | id))
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, correlation=corAR1(form = days | id), data=ecosystem)
head(ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = 1 | days), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = 1 | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = ~ 1 | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corAR1(form = ~ 1 | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1()(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ 1 | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~days|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
head(ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
coef(summary(fit))
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ 1 | days), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ 1 | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ treatment*days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ 1 + days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, correlation=corCAR1(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, correlation=corCAR1(form = ~ days), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~days|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ days|id, correlation=corCAR1(form = ~ days | id), data=ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ |id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
?corClasses
names(ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ 1 | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ treatment|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ treatment|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="ML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="ML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="ML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
head(ecosystem)
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ 1 | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id/days, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id/treatment, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(sqrt(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme(log(GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
fit <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
anova(fit, type="marginal")
# use the models that reproduce, not the models specified in methods
m1 <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
emtrends(m1, pairwise ~ treatment, var = "days")
?emtrends
# use the models that reproduce, not the models specified in methods
m1 <- lme((GPP.no0) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
emtrends(m1, pairwise ~ treatment, var = "days")
m2 <- lme(log(Chl) ~ treatment*days, random = ~ 1|id, correlation=corCAR1(form = ~ days | id), data=ecosystem, method="REML")
emtrends(m2, pairwise ~ treatment, var = "days")
800/40/4.3
1200/40/4.25
#$271/credit for instate
271*3*70
40*3*27
40*3*271
80*3*271
20*1.5*271
fn <- "Subalusky_2018_mara_river_biofilm_summary_data.csv"
file_path <- paste(data_folder, folder, fn, sep="/")
river <- fread(file_path)
head(river)
fit <- lm(GPP ~ site, data=river)
(fit.emm <- emmeans(fit, specs="site"))
contrast(fit.emm, method="revpairwise")
site_levels <- c("No Wildlife", "Hippo", "Hippo + WB")
river[, site_keyed:=factor(ifelse(site=="Site 1", site_levels[1],
ifelse(site=="Site 2", site_levels[2], site_levels[3])),
site_levels)
]
fit <- lm(GPP ~ site_keyed, data=river)
(fit.emm <- emmeans(fit, specs="site"))
site_levels <- c("No Wildlife", "Hippo", "Hippo + WB")
river[, site_fac:=factor(ifelse(site=="Site 1", site_levels[1],
ifelse(site=="Site 2", site_levels[2], site_levels[3])),
site_levels)
]
fit <- lm(GPP ~ site_fac, data=river)
(fit.emm <- emmeans(fit, specs="site_fac"))
contrast(fit.emm, method="revpairwise")
fit <- lm(Chl ~ site_fac, data=river)
(fit.emm <- emmeans(fit, specs="site_fac"))
contrast(fit.emm, method="revpairwise")
fit <- lm(Chl ~ site_fac, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site_fac"))
contrast(fit.emm, method="revpairwise")
head(river)
fit <- lm(Chl ~ site.wb, data=river)
anova(fit)
unique(river$site.wb)
dim(river)
names(river)
tail(river)
fit <- lm(Chl ~ site.wb, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(CR ~ site_fac, data=river)
anova(fit)
fit <- lm(CR ~ site_fac, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site_fac"))
contrast(fit.emm, method="revpairwise")
fit <- lm(AFDM ~ site_fac, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site_fac"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river[site.wb!="Site 1 - no wb"])
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river[site.wb!="Site 1 - no wb" & site.wb!="Site 2 - no wb"])
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river[site!="Site 1"])
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
fit <- lm(Chl ~ site.wb, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb"))
contrast(fit.emm, method="revpairwise")
head(river)
river
river[, site.wb2:=ifelse(site!="Site 3", site, site.wb)]
river
# river[, .(Chl=mean(Chl), N=.N), by=.(site.wb)]
# fit <- lm(Chl ~ site.wb, data=river)
# anova(fit)
# (fit.emm <- emmeans(fit, specs="site.wb"))
# contrast(fit.emm, method="revpairwise")
river[, site.wb2:=ifelse(site!="Site 3", site, site.wb)]
fit <- lm(Chl ~ site.wb2, data=river)
anova(fit)
(fit.emm <- emmeans(fit, specs="site.wb2"))
contrast(fit.emm, method="revpairwise")
fit <- lm(ln_hippo_prop_rem ~ treatment_recode*days, data=decomp[treatment_recode!="wb"])
summary(aov(fit))
fit <- lm(ln_hippo_prop_rem ~ treatment_recode*days, data=decomp[treatment_recode!="aged"])
summary(aov(fit))
fit <- lm(ln_hippo_prop_rem ~ treatment_recode*days, data=decomp[treatment_recode!="fresh"])
summary(aov(fit))
