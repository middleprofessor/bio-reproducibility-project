row
rows
table
b_table <- summary(contrast(fit.emm, method='revpairwise'))
rows <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
kable(b_table[contrast %in% rows])
rows
b_table
kable(b_table[, "contrast" %in% rows])
kable(b_table[, "contrast" %in% rows])
kable(b_table[, "contrast" %in% rows])
b_table
inc <- which(b_table[,"contrast"]%in%rows_labels)
rows_labels <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], 3)
kable(b_table[inc, ], digits=3)
b_table
form
fit.emm
b_table
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='none')
b_table
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
rows_labels <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3)
?summary.emmGrid
?kable
fit <- lmer(form, data=dt, REML=FALSE)
fit.emm <- emmeans(fit, specs=c('treatment', 'season'))
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='tukey')
rows_labels <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='Tukey')
fit.emm <- emmeans(fit, specs=c('treatment', 'season'))
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='none')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='No adjustment')
fit <- lmer(form, data=dt, REML=FALSE)
fit.emm <- emmeans(fit, specs=c('treatment', 'season'))
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='tukey')
rows_labels <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='Tukey')
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='none')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='No adjustment')
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='tukey')
rows_labels <- c('LR,dry - LA,dry', 'LR,dry - CT,dry', 'LA,dry - CT,dry',
'LR,wet - LA,wet', 'LR,wet - CT,wet', 'LA,wet - CT,wet')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='Tukey')
# no adjustment
b_table <- summary(contrast(fit.emm, method='revpairwise'), adjust='none')
inc <- which(b_table[,"contrast"]%in%rows_labels)
kable(b_table[inc, ], digits=3, caption='No adjustment')
blogdown:::serve_site()
r
r
form <- list()
random <- list()
fixed <- paste(y,"~", paste(x, collapse='*'))
random[[1]] <- paste(paste("(1|", r, ")", sep=""), collapse=" + ")
min_aic <- 1
# fit random part first
if(length(r) > 1){
aic <- numeric(3)
form <- formula(paste(fixed, random[[1]], sep=' + '))
fit1 <- lmer(form, data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
r1 <- r[1] # just the first random element
random[[2]] <- paste(paste("(1|", r1, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[2]], sep=' + '))
fit2 <- lmer(form, data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
r2 <- r[2] # just the second random element
random[[3]] <- paste(paste("(1|", r2, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[3]], sep=' + '))
fit3 <- lmer(form, data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
min_aic <- which(aic == min(aic))
}
random <- random[[min_aic]]
# fit fixed part
# fit with ML, choose model, then refit with REML
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=TRUE)
aic[3] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=TRUE)
aic[4] <- AIC(fit4)
min_aic <- which(aic == min(aic))
form[[min_aic]]
aic
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=TRUE)
aic[4] <- AIC(fit4)
min_aic <- which(aic == min(aic))
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=TRUE)
aic[4] <- AIC(fit4)
min_aic <- which(aic == min(aic))
aic
form
form <- list()
random <- list()
fixed <- paste(y,"~", paste(x, collapse='*'))
random[[1]] <- paste(paste("(1|", r, ")", sep=""), collapse=" + ")
min_aic <- 1
# fit random part first
if(length(r) > 1){
aic <- numeric(3)
form <- formula(paste(fixed, random[[1]], sep=' + '))
fit1 <- lmer(form, data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
r1 <- r[1] # just the first random element
random[[2]] <- paste(paste("(1|", r1, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[2]], sep=' + '))
fit2 <- lmer(form, data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
r2 <- r[2] # just the second random element
random[[3]] <- paste(paste("(1|", r2, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[3]], sep=' + '))
fit3 <- lmer(form, data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
min_aic <- which(aic == min(aic))
}
random <- random[[min_aic]]
# fit fixed part
# fit with ML, choose model, then refit with REML
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=TRUE)
aic[4] <- AIC(fit4)
form
form[[1]]
form[[2]]
form[[3]]
form[[4]]
fixed <- paste(y,"~", paste(x, collapse='*'))
random <- list()
random[[1]] <- paste(paste("(1|", r, ")", sep=""), collapse=" + ")
min_aic <- 1
# fit random part first, if there are > 1 random variables
if(length(r) > 1){
aic <- numeric(3)
form <- formula(paste(fixed, random[[1]], sep=' + '))
fit1 <- lmer(form, data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
r1 <- r[1] # just the first random element
random[[2]] <- paste(paste("(1|", r1, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[2]], sep=' + '))
fit2 <- lmer(form, data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
r2 <- r[2] # just the second random element
random[[3]] <- paste(paste("(1|", r2, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[3]], sep=' + '))
fit3 <- lmer(form, data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
min_aic <- which(aic == min(aic))
}
random <- random[[min_aic]]
# fit fixed part
form <- list()
# fit with ML, choose model, then refit with REML
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=TRUE)
aic[4] <- AIC(fit4)
min_aic <- which(aic == min(aic))
aic
select_model <- function(y, x, r, dt, reml=FALSE){
# the data are in dt
# y is the response column name
# x is the list of fixed effect column names
# r is the list of random effect column names
# it would seem wierd to have both month and plot in model
# see 5.7 of Zuur for model selection of mixed effect models
fixed <- paste(y,"~", paste(x, collapse='*'))
random <- list()
random[[1]] <- paste(paste("(1|", r, ")", sep=""), collapse=" + ")
min_aic <- 1
# fit random part first, if there are > 1 random variables
if(length(r) > 1){
aic <- numeric(3)
form <- formula(paste(fixed, random[[1]], sep=' + '))
fit1 <- lmer(form, data=dt, REML=TRUE)
aic[1] <- AIC(fit1)
r1 <- r[1] # just the first random element
random[[2]] <- paste(paste("(1|", r1, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[2]], sep=' + '))
fit2 <- lmer(form, data=dt, REML=TRUE)
aic[2] <- AIC(fit2)
r2 <- r[2] # just the second random element
random[[3]] <- paste(paste("(1|", r2, ")", sep=""), collapse=" + ")
form <- formula(paste(fixed, random[[3]], sep=' + '))
fit3 <- lmer(form, data=dt, REML=TRUE)
aic[3] <- AIC(fit3)
min_aic <- which(aic == min(aic))
}
random <- random[[min_aic]]
# fit fixed part
form <- list()
# fit with ML, choose model, then refit with REML
aic <- numeric(4)
form[[1]] <- formula(paste(fixed, random, sep=' + '))
# default is REML
fit1 <- lmer(form[[1]], data=dt, REML=reml)
aic[1] <- AIC(fit1)
fixed <- paste(y,"~", paste(x, collapse=' + '))
form[[2]] <- formula(paste(fixed, random, sep=' + '))
fit2 <- lmer(form[[2]], data=dt, REML=reml)
aic[2] <- AIC(fit2)
fixed <- paste(y,"~", x[1])
form[[3]] <- formula(paste(fixed, random, sep=' + '))
fit3 <- lmer(form[[3]], data=dt, REML=reml)
aic[3] <- AIC(fit3)
fixed <- paste(y,"~", x[2])
form[[4]] <- formula(paste(fixed, random, sep=' + '))
fit4 <- lmer(form[[4]], data=dt, REML=reml)
aic[4] <- AIC(fit4)
min_aic <- which(aic == min(aic))
return(form[[min_aic]])
}
y <- 'FRB'
x <- c('treatment', 'season')
r <- c('plot', 'month') # should this include "month"?
dt <- frb[depth==5]
# model select
form <- select_model(y, x, r, dt, reml=TRUE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
form
# anova
anova(lmer(form, data=dt, REML=TRUE), type=3) # replicates
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=TRUE), type=3) # replicates
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
form <- select_model(y, x, r, dt, reml=TRUE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
# anova(lmer(form, data=dt, REML=TRUE), type=3)
fit
emmeans(fit, pairwise ~ treatment | season)[[2]]
emmeans(fit, pairwise ~ treatment | season)
emmeans(fit, pairwise ~ treatment * season)[[2]]
emmeans(fit, pairwise ~ treatment + season)[[2]]
dt <- frb[depth==10]
form <- select_model(y, x, r, dt)
anova(lmer(form, data=dt, REML=FALSE), type=3)
dt <- frb[depth==10]
form <- select_model(y, x, r, dt)
anova(lmer(form, data=dt, REML=FALSE), type=3)
fit <- lmer(form, data=dt, REML=FALSE)
b_table <- emmeans(fit, pairwise ~ treatment | season)[[2]]
fit <- lmer(form, data=dt, REML=FALSE)
b_table <- emmeans(fit, pairwise ~ treatment | season)[[2]]
y <- 'FRB'
x <- c('treatment', 'season')
r <- c('plot', 'month') # should this include "month"?
dt <- frb[depth==5]
# model select
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
# anova(lmer(form, data=dt, REML=TRUE), type=3)
# manual F
1-pf(10.1538, 1, 11.823)
# published numbes
1-pf(10.1538, 1, 178) # hmm. okay so not < 0.001
fit <- lmer(form, data=dt, REML=FALSE)
b_table <- emmeans(fit, pairwise ~ treatment | season)[[2]]
kable(b_table, digits=3, caption='Tukey')
y <- 'FRB'
x <- c('treatment', 'season')
r <- c('plot', 'month') # should this include "month"?
dt <- frb[depth==10]
# model select
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3) # replicates
# anova(lmer(form, data=dt, REML=TRUE), type=3)
form <- formula(FRB ~ treatment*season + (1|plot) + (1|month))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
dt
form <- formula(FRB ~ treatment+season + (1|plot) + (1|month))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
form <- formula(FRB ~ treatment+season + (1|plot)
fit1 <- lmer(form, data=dt, REML=FALSE)
form <- formula(FRB ~ treatment+season + (1|plot))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
form <- formula(FRB ~ season + (1|plot))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
form <- formula(FRB ~ season
fit1 <- lmer(form, data=dt, REML=FALSE)
form <- formula(FRB ~ season)
fit1 <- lmer(form, data=dt, REML=FALSE)
fit1 <- lm(form, data=dt)
anova(fit1)
form <- formula(FRB ~ treatment+season)
#fit1 <- lmer(form, data=dt, REML=FALSE)
fit1 <- lm(form, data=dt)
anova(fit1)
form <- formula(FRB ~ treatment*season + (1|month))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
form <- formula(FRB ~ season + (1|month))
fit1 <- lmer(form, data=dt, REML=FALSE)
anova(fit1)
form <- formula(FRB ~ season*treatment + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season+treatment + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season + (1|plot) + (1|month))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season*treatment + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season+treatment + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season + (1|plot))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season*treatment + (1|month))
anova(lmer(form, data=dt, REML=FALSE))
form <- formula(FRB ~ season*treatment)
anova(lm(form, data=dt))
form <- formula(FRB ~ season + treatment)
anova(lm(form, data=dt))
FRL_cols <- c("FRL5cmJun13", "FRL5cmAug13", "FRL5cmSep13", "FRL5cmOct13", "FRL5cmNov13", "FRL5cmDec13", "FRL5cmJan14", "FRL5cmFeb14", "FRL5cmMar14", "FRL5cmApr14", "FRL5cmMay14", "FRL10cmJun13", "FRL10cmAug13", "FRL10cmSep13",  "FRL10cmOct13", "FRL10cmNov13", "FRL10cmDec13", "FRL10cmJan14", "FRL10cmFeb14", "FRL10cmMar14", "FRL10cmApr14", "FRL10cmMay14")
# what are these "FRB5cmJul13__1", "FRB10cmJul13__1" they have values more like FRL than FRB
frl <- melt(root, id.vars=c('treatment', 'plot'), measure.vars <- FRL_cols, variable.name='label', value.name='FRL')
frl[, treatment:=factor(treatment)]
frl[, label:=as.character(label)]
frl[, depth:=factor(ifelse(substr(label, 4, 4)=='5', 5, 10))]
frl[, month:=substr(label, nchar(label)-4, nchar(label)-2)]
dry <- c('Jan', 'Feb', 'Mar', 'Apr')
frl[, season:=factor(ifelse(month %in% dry, 'dry', 'wet'))]
y <- 'FRL'
x <- c('treatment', 'season')
r <- c('plot', 'month')
dt <- frl[depth==5]
# model select
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3)
form
form
y <- 'FRL'
x <- c('treatment', 'season')
r <- c('plot', 'month')
dt <- frl[depth==10]
# model select
form <- select_model(y, x, r, dt, reml=FALSE)
# anova
anova(lmer(form, data=dt, REML=FALSE), type=3)
frb5 <- frb[depth==5, .(N=.N,
FRB=mean(FRB),
SE=sd(FRB)/sqrt(.N)),
by=.(treatment, season)]
frb10 <- frb[depth==10, .(N=.N,
FRB=mean(FRB),
SE=sd(FRB)/sqrt(.N)),
by=.(treatment, season)]
frb_sum <- rbind(data.frame(depth=5, frb5), data.frame(depth=10, frb10))
frb_sum
gg <- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(cols=depth) +
theme_minimal(base_size=14)
frb_sum[, Lower:=FRB-SE]
gg <- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(cols=vars(depth)) +
theme_minimal(base_size=14)
gg <- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(.~depth) +
theme_minimal(base_size=14)
gg
frb_sum
frb_sum[, Lower:=FRB-SE]
frb_sum <- rbind(data.table(depth=5, frb5), data.table(depth=10, frb10))
frb_sum[, Lower:=FRB-SE]
frb_sum[, Upper:=FRB+SE]
frb_sum[, season:=factor(season, c('dry', 'wet'))]
frb_sum[, treatment:=factor(treatment, c('LR', 'CT', 'LA'))]
pd <- position_dodge(.6)
gg <- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(.~depth) +
theme_minimal(base_size=14)
gg
gg <- ggplot(data=frb_sum, aes(x=season, y=FRB, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(.~depth, labeller = label_both) +
theme_minimal(base_size=14)
gg
frb5 <- frl[depth==5, .(N=.N,
FRB=mean(FRB),
SE=sd(FRB)/sqrt(.N)),
by=.(treatment, season)]
frl5 <- frl[depth==5, .(N=.N,
FRL=mean(FRL),
SE=sd(FRL)/sqrt(.N)),
by=.(treatment, season)]
frl10 <- frl[depth==10, .(N=.N,
FRL=mean(FRL),
SE=sd(FRL)/sqrt(.N)),
by=.(treatment, season)]
frl_sum <- rbind(data.table(depth=5, frl5), data.table(depth=10, frl10))
frl_sum[, Lower:=FRL-SE]
frl_sum[, Upper:=FRL+SE]
frl_sum[, season:=factor(season, c('dry', 'wet'))]
frl_sum[, treatment:=factor(treatment, c('LR', 'CT', 'LA'))]
pd <- position_dodge(.6)
gg <- ggplot(data=frl_sum, aes(x=season, y=FRL, fill=treatment)) +
geom_col(position=pd, width=0.6, color='black') +
geom_errorbar(aes(ymin=Lower, ymax=Upper), width=.2, position=pd) +
scale_fill_manual(values=c("white", "gray", "black")) +
facet_grid(.~depth, labeller = label_both) +
theme_minimal(base_size=14)
gg
